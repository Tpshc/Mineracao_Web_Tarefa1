ar
X
iv
:1
70
9.
01
33
4v
1 
 [
cs
.C
R
] 
 5
 S
ep
 2
01
7
1
Optimal Power Allocation by Imperfect
Hardware Analysis in Untrusted Relaying
Networks
Ali Kuhestani, Student Member, IEEE, Abbas Mohammadi, Senior Member, IEEE,
Kai-Kit Wong, Fellow, IEEE, Phee Lep Yeoh, Member, IEEE,
Majid Moradikia, and Muhammad R. A. Khandaker, Member, IEEE
Abstract
By taking a variety of realistic hardware imperfections into consideration, we propose an optimal
power allocation (OPA) strategy to maximize the instantaneous secrecy rate of a cooperative wireless
network comprised of a source, a destination and an untrusted amplify-and-forward (AF) relay. We
assume that either the source or the destination is equipped with a large-scale multiple antennas
(LSMA) system, while the rest are equipped with a single antenna. To prevent the untrusted relay from
intercepting the source message, the destination sends an intended jamming noise to the relay, which is
referred to as destination-based cooperative jamming (DBCJ). Given this system model, novel closed-
form expressions are presented in the high signal-to-noise ratio (SNR) regime for the ergodic secrecy
rate (ESR) and the secrecy outage probability (SOP). We further improve the secrecy performance
of the system by optimizing the associated hardware design. The results reveal that by beneficially
distributing the tolerable hardware imperfections across the transmission and reception radio-frequency
(RF) front ends of each node, the system’s secrecy rate may be improved. The engineering insight is
that equally sharing the total imperfections at the relay between the transmitter and the receiver provides
the best secrecy performance. Numerical results illustrate that the proposed OPA together with the most
appropriate hardware design significantly increases the secrecy rate.
A. Kuhestani and A. Mohammadi are with the Electrical Engineering Department, Amirkabir University of Technology,
Tehran, Iran.
K.-K Wong and M. R. A. Khandaker are with the Department of Electronic and Electrical Engineering, University College
London, London WC1E 6BT, U.K.
P. L. Yeoh is with the School of Electrical and Information Engineering, The University of Sydney, NSW, Australia.
M. Moradikia is with the Electrical Engineering Department, Shiraz University of Technology, Shiraz, Iran.
2
Index Terms
Physical layer security, Untrusted relay, Hardware imperfections, Optimal power allocation, Hard-
ware design
I. INTRODUCTION
Security in wireless communication networks is conventionally implemented above the phys-
ical layer using key based cryptography [1]. To complement these highly complex schemes,
wireless transmitters can also be validated at the physical layer by exploiting the dynamic
characteristics of the associated communication links [2], [3]. Physical layer security (PLS) is
a promising paradigm for safeguarding fifth-generation (5G) wireless communication networks
without incurring additional security overhead [3].
Massive multiple-input multiple-output (MIMO) systems as a key enabling technology of
5G wireless communication networks provide significant performance gains in terms of spectral
efficiency and energy efficiency [4], [5]. This new technology employs coherent processing across
arrays of hundreds or even thousands of base station (BS) antennas and supports tens or hundreds
of mobile terminals [4]–[6]. As an additional advantage, massive MIMO is inherently more secure
than traditional MIMO systems, as the large-scale antenna array exploited at the transmitter can
precisely aim a narrow and directional information beam towards the intended receiver, such that
the received signal-to-noise ratio (SNR) is several orders of magnitude higher than that at any
incoherent passive eavesdropper [7]. However, these security benefits are severely hampered in
cooperative networks where the intended receivers may also be potential eavesdroppers [8]–[10].
In the context of PLS, cooperative jamming which involves the transmission of additional
jamming signals to degrade the received SNR at the potential eavesdropper can be applied by
source [9], [10], the intended receiver node [8] or a set of nodes, i.e., source and destination
or source and relay to beamform the jamming noise orthogonal to the spatial dimension of the
desired signal [11], [12]. Recently, several works have considered the more interesting scenario
of untrusted relaying [13]–[21] where the cooperative jamming is performed by the intended
receiver, which is referred to as destination-based cooperative jamming (DBCJ).
In real life, an untrusted, i.e., honest-but-curious, relay may collaborate to provide a reliable
communication. Several practical scenarios may include untrusted relay nodes, e.g., in ultra-dense
heterogenous wireless networks where low-cost intermediate nodes may be used to assist the
source-destination transmission. In these networks, it is important to protect the confidentiality
3
of information from the untrustworthy relay, while concurrently relying on it to increase the
reliability of communication. Thanks to the DBCJ strategy [8], positive secrecy rate can still
be attained in untrusted relay networks. In recent years, several works have focused on the
performance analysis [13]–[16], power allocation [17]–[20] and security enhancement [18], [21]
of untrusted relaying networks. To be specific, the authors in [17] proposed an optimal power
allocation (OPA) strategy to maximize the instantaneous secrecy rate of one-way relaying network
while two-way relaying scenario was considered in [18]. By exploiting the direct link, a source-
based artificial noise injection scheme was proposed in [19] to hinder the untrusted relay from
intercepting the confidential message. A power allocation strategy was also proposed in [19] to
optimally determine the information and jamming signal powers transmitted by the source. In
[20], the OPA problem with imperfect channel state information was investigated. Notably, all
the aforementioned works considered perfect hardware in the communication network.
In practice, hardware equipments experience detrimental impacts of phase noise, I/Q imbal-
ance, amplifier non-linearities, quantization errors, converters, mixers, filters and oscillators [22],
[23]. Each of the imperfections distorts the signals in its own way. While hardware imperfections
are unavoidable, the severity of the imperfections depends on the quality of the hardware used in
the radio-frequency (RF) transceivers. The non-ideal behavior of each component can be modeled
in detail for the purpose of designing compensation algorithms, but even after compensation there
remain residual transceiver imperfections [23]. This problem is more challenging especially in
high rate systems such as LTE-Advanced and 5G networks exploiting inexpensive equipments
[22]. Although most contributions in security based wireless networks have assumed perfect
transceiver hardware [8]–[21], or only investigated the impact of particular imperfections such
as I/Q imbalance [25] or phase noise [26] in the presence of an external eavesdropper, this paper
goes beyond these investigations by considering residual hardware imperfections in physical
layer security design [22]–[24].
In this paper, we take into account the OPA in a two-hop amplify-and-forward (AF) untrusted
relay network where all the nodes suffer from hardware imperfections and either the source or
the destination is equipped with large-scale multiple antennas (LSMA) [27], [28] while the other
nodes are equipped with a single antenna. The DBCJ protocol is operated in the first phase and
then the destination perfectly removes the jamming signal via self interference cancelation in
the second phase. For this system model, the main contributions of the paper are summarized
as follows:
4
• Inspired by [22]–[24], we first present the generalized system model for transceiver hardware
imperfections in our secure transmission network. Based on this, we calculate the received
instantaneous signal-to-noise-plus-distortion-ratio (SNDR) at the relay and destination.
• We formulate the OPA between the source and destination that maximizes the instantaneous
secrecy rate of untrusted relaying. Accordingly, novel closed-form solutions are derived for
the exact OPA. In addition, new simple solutions are derived for the OPA in the high SNR
regime.
• According to our OPA solutions, novel compact expressions are derived for the ergodic
secrecy rate (ESR) and secrecy outage probability (SOP) in the high signal-to-noise-ratio
(SNR) regime that can be applied to arbitrary channel fading distributions. To gain further
insights, new closed-form expressions are presented over Rayleigh fading channels. The
asymptotic results highlight the presence of a secrecy rate ceiling which is basically different
from the prefect hardware case. We highlight that this ceiling phenomenon is independent
of the fading characteristic of the two hops.
• We provide new insights for hardware design in DBCJ-based secure communications. To
this end, under the cost constraint of transceiver hardware at each node, we formulate the
hardware design problem for the aforementioned network to maximize the secrecy rate. The
results reveal that the secrecy rate can be improved by optimally distributing the level of
hardware imperfections between the transmit and receive RF front ends of each node.
Notation: We use bold lower case letters to denote vectors. IN and 0N×1 denote the Identity
matrix and the zeros matrix, respectively. ?.?, (.)H and (.)T denote the Euclidean norm, conjugate
transpose and transpose operators, respectively; Ex{·} stands for the expectation over the random
variable (r.v.) x; Pr(·) denotes the probability; fX(·) and FX(·) denote the probability density
function (pdf) and cumulative distribution function (cdf) of the r.v. X , respectively; the CN (µ, ?2)
denotes a circularly symmetric complex Gaussian RV with mean µ and variance ?2; diag(A)
stands for the main diagonal elements of matrix A; Ei(x) is the exponential integral [34, Eq.
(8.211)]. [·]+ = max{0, x} and max stands for the maximum value.
II. SIGNAL AND SYSTEM REPRESENTATION
A. System Model
As shown in Fig. 1, the system model under consideration is a wireless network with one
source (S), one destination (D) and one untrusted AF relay (R). While R is equipped with one
5
Fig. 1. Secure transmission under the presence of transceiver imperfections. The first and the second figures show the downlink
and the uplink transmissions, respectively. The relay acts as both helper and eavesdropper. The solid lines represent the first
phase of transmission while the dashed line represents the second phase of transmission.
antenna, S or D is equipped with LSMA denoted by Ns or Nd, respectively [29], [30]. This
corresponds to the downlink (DL) and uplink (UL) scenarios in a cellular system where the
base station is equipped with a LSMA and the mobile user and relay are equipped with a single
antenna [29]. In the DL scenario, S has many antennas, whereas D has a single antenna. The
opposite applies to the UL scenario.
All the nodes operate in a half-duplex mode. Accordingly, D cannot receive the transmitted
signal from S while transmitting the jamming signal and hence, the direct link between S and
D is unavailable. We also assume that the channels satisfy the reciprocity theorem [8]. In DL
transmission, the complex Gaussian channel from S to R and R to D are denoted by hsr ?
CN (0Ns×1, µsrINs) and hrd ? CN (0, µrd), respectively, and for UL transmission, they are denoted
by hsr ? CN (0, µsr) and hrd ? CN (0Nd×1, µrdINd), respectively. We consider slow fading such
that the channel coefficients vary independently from one frame to another frame and, they do not
change within one frame. The additive white noise ni (i ? {R,D}) at each receiver is represented
by a zero-mean complex Gaussian variable with variance N0. We define the SNRs per link as
6
?sr
?
=??hsr?2 and ?rd?=??hrd?2 and hence, the average SNRs per branch is given by ?sr = ?µsr
and ?rd = ?µrd, where ? =
P
N0
represents the transmit SNR of the network. The maximum ratio
transmission (MRT) beamforming and maximal ratio combining (MRC) processing are applied
at the multi-antenna node to improve the overall system performance [29]. Let ? = ?sr
?rd
represent
the ratio between the source-to-relay and relay-to-destination SNRs. With LSMA, we consider
? ? 1 in the DL scenario while ? ? 1 in the UL scenario. These two special cases are taken
into account in this paper. As observed in the numerical results, the analysis are satisfactory
even for moderate values of ?.
The DBCJ technique is applied to degrade the received signal at the untrusted relay such
that it cannot decipher the desired information. The whole transmission is performed based on
a time-division multiple-access (TDMA) based protocol such that the message transmission is
divided into two phases, i.e. the broadcast phase and the relaying phase. We consider a total
transmit power budget for S and D of P with power allocation factor ? ? (0, 1) such that the
transmit powers at S and D are ?P and (1 ? ?)P , respectively [14], [18]. As such, during the
first phase, while S transmits the intended signal with power ?P , concurrently D jams with a
Gaussian noise to confuse the untrusted relay with power (1? ?)P . For simplicity, the transmit
power at R is set to P and accordingly, in the second phase of transmission, R simply broadcasts
the amplified version of the received signal with power of P .
In order to consider the residual transceiver imperfections (after conventional compensation
algorithms have been applied) at node i, i ? {S,R,D}, the generalized system model from
[22] is taken into account. The imperfection at transmission and reception segments denoted
by ?ti and ?
r
i respectively, are introduced as distortion noises. The experimental results in [23]
and many theoretical investigations in [23], [31] have verified that these distortion noises are
well-modeled as Gaussian distributions due to the central limit theorem. A key property is that
the variance of distortion noise at an antenna is proportional to the signal power at that antenna
[23]. Accordingly, for the DL scenario, we have [23]
?
t
S?CN
(
0,
?PktS
2
?hsr?2
diag(|hsr1|2 ... |hsrNs |2)
)
,
?tD?CN
(
0, (1? ?)PktD
2
)
,
?rD?CN
(
0, PkrD
2|hrd|2
)
. (1)
7
Furthermore, we have
?tS?CN
(
0, ?Pkts
2
)
,
?
t
D?CN
(
0,
(1? ?)PktD2
?hrd?2
diag(|hrd1|2 ... |hrdNd |
2)
)
,
?
r
D?CN
(
0, PkrD
2diag(|hrd1|2 ... |hrdNd |
2)
)
, (2)
for the UL scenario. The imperfections at R of both cases are also given by
?tR?CN
(
0, PktR
2
)
,
?rR?CN
(
0, PkrR
2
[
??hsr?2 + (1? ?)?hrd?2
])
, (3)
where the design parameters kti , k
r
i > 0 for i ? {S,R,D} characterize the level of imperfections
in the transmitter and receiver hardware, respectively. These parameters can be interpreted as the
error vector magnitudes (EVMs). EVM determines the quality of RF transceivers and is defined
as the ratio of the average distortion magnitude to the average signal magnitude. Since the EVM
measures the joint effect of different hardware imperfections and compensation algorithms, it
can be measured directly in practice [22]. 3GPP LTE has EVM requirements in the range of
kti , k
r
i ? [0.08, 0.175], where smaller values are needed to achieve higher spectral efficiencies
[24].
Remark 1 (Co-channel Interference): The analysis in this paper supports the scenario of
large enough number of interfering signals, which is typical in wireless environments where
the Gaussian assumption for the interference is valid by applying the central limit theorem [32].
B. Signal Representation
Let us denote xS and xD as the unit power information signal and the jamming signal, respec-
tively. According to the combined impact of hardware imperfections which is well-addressed
by a generalized channel model [22], the received signal at R for DL and UL scenarios can be
expressed, respectively as
yDLR =
(?
?PwTS xS + ?
t
S
T
)
hsr +
(?
(1? ?)PxD + ?tD
T
)
hrd + ?
r
R + nR, (4)
and
yULR =
(?
?PxS + ?
t
S
T
)
hsr +
(?
(1? ?)PwTDxD + ?tD
T
)
hrd + ?
r
R + nR, (5)
8
where wS =
hsr
H
?hsr? and wD =
hrd
H
?hrd? represent the MRT transmit weight vectors at S and D,
respectively. Observe from (4) and (5) that the propagated distortion noises by S and D, and the
self-distortion noise at R are treated as interference at the untusted relay which is a potential
eavesdropper. As a result, the engineering insight is to beneficially forward these hardware
imperfections to make the system secure instead of injecting more artificial noise by S [9], [10],
[19], D [13]–[17], [20] or a friendly jammer [18].
Then the relay amplifies its received signal in the first phase by an amplification factor of 1
G =
?
P
E|yR|2
=
?
?
AG?+BG
, (6)
where AG = (?sr ? ?rd)(1 + krR2) + ktS2?u ? ktD2?v and BG = ?rd(1 + krR2) + ktD2?v + 1. Note
that in the DL scenario ?u = ?
? |hsri |4/?hsr?2 and ?v = ?rd, and in the UL scenario ?u = ?sr
and ?v = ?
? |hrdi|4/?hrd?2. Then, the received signal at D for DL and UL scenarios after
self-interference (or jamming signal) cancelation are respectively, given by
yDLD =G
?
?PwHS hsrhrdxS? ?? ?
Information signal
+GhrdnR + nD? ?? ?
Noise
+G?tS
T
hsrhrd +G?
r
Rhrd +G?
t
D
T
hrdhdr + ?
t
Rhrd + ?
r
D? ?? ?
Distortion noise
,
(7)
and
yULD = G
?
?PhsrhrdxS? ?? ?
Information signal
+GhrdnR + nD? ?? ?
Noise
+G?tS
T
hsrhrd +G?
r
Rhrd +G?
t
D
T
hrdhdr + ?
t
Rhrd + ?
r
D? ?? ?
Distortion noise
.
(8)
According to (4) and (5) and after some algebraic manipulations, the SNDR at R is given by
?R =
??
AR?+BR
, (9)
where AR = k
r
R
2? + ktS
2 ?u
?rd
? ktD2 ?v?rd ? k
r
R
2 ? 1 and BR = 1+ krR2 + ktD2 ?v?rd +
1
?rd
. Based on (7)
and (8) and after some manipulations, the SNDR at D can be calculated as
?D =
??sr
AD?+BD
, (10)
where AD = (?sr??rd)(krD2krR2+krR2ktR2+k2R+krD2)+?u(krD2ktS2+ktR2ktS2+ktS2)+?v(krD2ktD2?
1In our analysis, we assume that the EVMs are perfectly known and will consider estimation errors in our future work.
9
ktR
2
ktD
2 ? ktD2) + (? ? 1)(1 + krR2) + ?u?rdk
t
S
2 ? ?v
?rd
ktD
2
and BD = ?rd(k
r
R
2krD
2 + krR
2ktR
2
+ k2R +
krD
2) + ?v(k
r
D
2ktD
2
+ ktR
2
ktD
2
+ ktD
2
) + ?v
?rd
ktD
2
+ 1
?rd
+ k2R + k
r
D
2 + 2. We define k2R
?
=ktR
2
+ krR
2
and k2D
?
=ktD
2
+ krD
2 as the total imperfection level at R and D, respectively.
Remark 2 (Perfect Hardware): The received SNRs at R and D with perfect hardware were
derived in [13], [14], [17]. When setting the level of imperfections at the nodes to zero, the
derived SNDRs in this section reduce to the special case as follows [14]
?perfectR =
??sr
(1? ?)?rd + 1
and ?perfectD =
??sr?rd
??sr + (2? ?)?rd + 1
. (11)
As can be seen, the mathematical structure of the derived SNDRs in (9), (10) are more com-
plicated compared to the perfect hardware case in (11), since the terms ?u
?rd
and ?u
?rd
manifest in
the denominator. As such, it is non-trivial to propose an OPA solution for the general scenario
of imperfect hardware. This generalization is done in Section III and is a main contribution of
this work.
For DL scenario, (9) and (10) are simplified to
?R =
aL?
?+ bL
and ?D =
cL?
?+ dL
, (12)
where
aL =
1
?1 ? 1
, bL =
?1
(?1 ? 1)?
, cL =
?rd
?2?rd + ?1
and dL =
?3?rd + ?4
?(?2?rd + ?1)
, (13)
and, ?1 = 1+ k
r
R
2 + ktD
2
, ?2 = k
r
D
2krR
2 + krR
2ktR
2
+ k2R + k
r
D
2, ?3 = ?2 + k
t
D
2
krD
2 + ktR
2
ktD
2
+ ktD
2
,
?4 = 2 + k
2
R + k
2
D and ?1 = 1 + k
r
R
2. Moreover, for UL scenario, we obtain
?R =
aS?
1? ? and ?D =
bS?
?+ cS
, (14)
where
aS =
?
?1
, bS =
?sr
(?sr ? ?rd)?2 + (? ? 1)?1
and cS =
?2?rd + ?2
(?sr ? ?rd)?2 + (? ? 1)?1
, (15)
and ?2 = 2 + k
2
R + k
r
D
2. Based on (12) and (14), we can conclude that although the intercept
probability is reduced by increasing the imperfection at R, the secrecy rate is also degraded.
It is, therefore, of great interest to intelligently distribute the tolerable hardware imperfections
across the transmission and reception radio frequency (RF) front ends of R (and other nodes) to
improve the secrecy rate of the network. This hardware design approach is analyzed in Section
10
VI and is a main contribution of this paper.
III. OPTIMAL POWER ALLOCATION
This section proceeds to analyze the optimal power allocation problem with the aim of
maximizing the instantaneous secrecy rate. Extending the results in [17], [19], [20] where the
OPA was solved for perfect hardware, we investigate the power allocation factor ? under the
presence of hardware imperfections. To do so, the instantaneous secrecy rate is evaluated by [8]
Rs =
1
2 ln 2
[
ln(1 + ?D)? ln(1 + ?R)
]+
. (16)
By substituting ? = 0 into (9), (10) and then (16), we find Rs = 0. Since our goal is to distribute
the power optimally between S and D, a non-negative secrecy rate is achievable. As such, the
instantaneous secrecy rate can be reformulated as
Rs =
1
2 ln 2
[
ln(1 + ?D)? ln(1 + ?R)
]
. (17)
Given that log(·) is monotonically increasing, the maximization of Rs is equivalent to the
maximization of
?(?)
?
=
1 + ?D
1 + ?R
. (18)
Therefore, the OPA factor ?? can be obtained by solving the following constrained optimization
problem
?? = arg max
{
?(?)
}
s.t. 0 < ? ? 1 (19)
Lemma 1: f(x) is a quasi-concave function in R, if and only if [33, Section 3.4.3]
?f(x)
?x
= 0 ? ?
2f(x)
?x2
? 0. (20)
Based on lemma 1, we have the following corollary.
Corollary 1: f(x) is a quasi-concave function in x ? [x1, x2], if ?f(x)?x |x=x1 > 0,
?f(x)
?x
|x=x2 < 0
and there is only one maximum over [x1, x2] (despite constant functions).
11
Proposition 1: ?(?) is a quasiconcave function of ? in the feasible set 0 < ? ? 1 and the
optimal point is given by
??E =
?
??
??
bLdL(cL?aL)+
?
?aLbLcLdL(bL?dL)(aLdL?bLcL?bL+dL)
aLbL(cL+1)?cLdL(aL+1) ; ? ? 1
1?
?
aS(cS+1)(bS+cS+1)
bScS
; ? ? 1
(21)
Proof: The first-order derivative of ?(?) on ? is given by
??(?)
??
=
?
??
??
AL?
2+BL?+CL
[(aL+1)?+bL]2[?+dL]2
; ? ? 1
AS?
2+BS?+CS
[1+(aL?1)?]2[?+cL]2 ; ? ? 1
, (22)
where AL = ?aLbL(cL+1)+cLdL(aL+1), BL = ?2bLdL(aL?cL), CL = ?aLbL dL2+bL2cL dL,
AS = (?bL (aL ? 1) cL ? aL (bL + 1)), BS = ?2 cL (aL + bL) and CS = ?aLcL2+bLcL. As can
be seen from (22),
??(?)
??
= 0 leads to two solutions on ?. It is easy to examine that the feasible
solution for practical values of kti and k
r
i [22] are derived as (21). According to Corollary 1, we
find that ?(?) is a quasiconcave function in the feasible set.
To make the further analysis tractable, we provide new compact expressions for the OPA in
the high SNR regime. In the case of DL, the expressions in (13) are simplified to
aL =
1
?1 ? 1
, bL =
?1
(?1 ? 1)?
, cL =
1
?2
, dL =
?3
?2?
, (23)
and in the case of UL scenario, the expressions in (15) are changed to
aS =
?
?1
, bS =
?
(? ? 1)?2
, cS =
1
? ? 1 . (24)
By substituting (23) and (24) into (21), the OPA solutions in the high SNR regime can be
expressed in the following tractable forms
??High=
?
??
??
?L
?
; DL
1? ?S? ; UL
(25)
where ?L =
?
?3
?2
(?1 ? ?3) + ?3?2 (?1 ? 1)? ?3 and ?S =
?
1+?2
?1
.
12
IV. ERGODIC SECRECY RATE
In this section, we derive the ESR of the proposed secure transmission scheme in each case
of DL and UL scenarios. Since it is not straightforward to obtain a closed-form expression for
the exact ESR of DL and UL scenarios (the exact ESR includes double integral expressions
due to the complicated structures of (21)), we therefore proceed by first deriving new analytical
expressions for the ESR in the high SNR regime that can be applied to arbitrary channel fading
distributions. Based on these, new closed-form expressions are derived for the ESR in Rayleigh
fading channels. Despite prior works in the literature [14], [16]–[21] that investigated the ESR
based on perfect hardware assumption in various untrusted relaying networks, we take into
account hardware imperfections. The new results in this section generalize the recent results in
[14], [17].
The ESR as a useful secrecy metric representing the rate below which any average secure
transmission rate is achievable [2]. As such, the ESR is given by
Rs = E
{
Rs
}
=
1
2 ln 2
[
E
{
ln(1 + ?D)
}
? ?? ?
T1
?E
{
ln(1 + ?R)
}
? ?? ?
T2
]
. (26)
In the following, we proceed to evaluate the parts T1 and T2 and then Rs for each case of DL
and UL scenarios. Towards this goal, we present the following useful lemma.
Lemma 2: For positive constants ?1, ?2 and ?3, and non-negative r.v. ?, the cdf of the new
r.v. ?? = ?1?
?2?+?3
is derived as
F??(x) =
?
??
??
F?
(
?3x
?1??2x
)
; 0 ? x < ?1
?2
1 ; x ? ?1
?2
(27)
Proof: We start from the definition of the cdf as follows
F??(x) = Pr
{ ?1?
?2? + ?3
? x
}
= Pr
{
?(?1 ? ?2x) ? ?3x
}
, (28)
where the last probability equals to one for ?1 ? ?2x < 0. Otherwise, it equals to F?
(
?3x
?1??2x
)
.
13
1) Downlink Scenario: By plugging (25) into (12), we obtain
?R =
?L
?L(?1 ? 1) + ?1
, (29)
?D =
?L?rd
(?2?L + ?3)?rd + ?1?L + ?4
. (30)
We find that all the terms in (29) and (30) are deterministic constants which leads to the secrecy
rate ceiling in the high SNR regime.
Based on lemma 2 and (30), the part T1 in (26) is given by
T1 = E
{
ln
(
1 +
?L?rd
(?2?L + ?3)?rd + ?1?L + ?4
)}
=
? ?L
?2?L+?3
0
1? F?rd
(
(?1?L+?4)x
?L?(?2?L+?3)x
)
1 + x
dx, (31)
where the last equation follows from the integration by parts. The expression in (31) is straight-
forwardly evaluated for any channel fading distribution, either directly or by a simple numerical
integration.
Furthermore, based on (30) the part T2 is a constant value as
T2 = ln
(
1 +
?L
?L(?1 ? 1) + ?1
)
. (32)
We conclude from (32) that the amount of information leakage is independent of the transmit
SNR and the position of the relay, and only depends on the EVMs at network nodes. By replacing
(31) and (32) into (26), the compact ESR expression is achieved for any channel distribution.
For the case of Rayleigh fading, due to the fact that ?rd is an exponential r.v. and applying
[34, Eq. (4.337.2)], the part T1 can be expressed in a closed-form solution. By substituting this
and (32) into (26), the closed-form ESR expression becomes
Rs
DL
=
1
2 ln 2
[
e
1
r2?rdEi(? 1
r2?rd
)? e
1
r1?rdEi(? 1
r1?rd
)? ln
(
1 +
?L
?L(?1 ? 1) + ?1
)]
, (33)
where r1 =
(1+?2)?L+?3
?1?L+?4
and r2 =
?2?L+?3
?1?L+?4
. We conclude from (33) that the ESR is exclusively
characterized by the level of imperfections over nodes and ?rd which is a function of the transmit
SNR and the distance-dependent channel gain µrd.
14
2) Uplink Scenario: Substituting (25) into (14) yields
?R=
??H?
(1? ??H)?1
? 1?
?1(1 + ?2)
, (34)
?D?
?sr
?2(1 +
?
1+?2
?1
)?sr + ?2 ? ?1
. (35)
Observe from (34) and (35) that only the first hop SNR, ?sr contributes to the secrecy rate
performance. Following the similar procedure as the DL scenario, the ESR performance of the
UL case for arbitrary fading distribution can be expressed as
Rs
UL
=
1
2 ln 2
(? 1
?2(1+
?
1+?2
?1
)
0
1? F?sr( (?2??1)x
1??2(1+
?
1+?2
?1
)x
)
1 + x
dx? ln(1 + 1?
?1(1 + ?2)
)
)
. (36)
For the case of Rayleigh fading, the closed-form ESR expression is given by
Rs
UL
=
1
2 ln 2
[
e
1
t2?srEi(? 1
t2?sr
)? e
1
t1?sr Ei(? 1
t1?sr
)? ln
(
1 +
1?
?1(1 + ?2)
)]
, (37)
where t1 =
1+?2(1+
?
1+?2
?1
)
?2??1 and t2 =
?2(1+
?
1+?2
?1
)
?2??1 . It is observed from (37) that the ESR is entirely
determined by the average channel gain of the first hop, the transmit SNR and the level of
imperfections of all the network nodes. We also find that increasing the number of antennas at
D has no impact on the ESR when Nd is large.
V. SECRECY OUTAGE PROBABILITY
In this section, similar to our ESR results, general expressions are first presented for the SOP
that can be applied to any channel distribution, under the presence of transceiver imperfections
and in the high SNR regime. Based on these, we derive novel closed-form expressions for the
SOP in Rayleigh fading channels.
The SOP denoted by Pso is a criterion that determines the fraction of fading realizations
where a secrecy rate Rt cannot be supported [13]. Accordingly, the overall SOP is defined as
the probability that a system with the instantaneous secrecy rate Rs is not able to support the
target transmission rate Rt; Pso = Pr
{
Rs < Rt
}
.
In the following, we focus on each case of DL and UL, respectively.
15
1) Downlink Scenario: Substituting (30) into (17) and then based on the SOP definition we
obtain
PDLso = Pr
( ?L?rd
(?2?L + ?3)?rd + ?1?L + ?4
? R?t
)
=
?
??
??
F?rd
(
(?1?L+?4)R?t
?L?(?2?L+?3)R?t
)
;Rt <
1
2
log2
(
1+
?L
?2?L+?3
1+?R
)
1 ;Rt ? 12 log2
(
1+
?L
?2?L+?3
1+?R
) (38)
where R?t = 2
2Rt(1+?R)?1 and ?R is in (29), and the last equation follows from using lemma 2.
It is worth pointing out that the SOP expressions in (38) allows the straightforward evaluation of
the SOP for any channel fading distribution by a simple numerical integration. We can conclude
from (38) that the SOP is always 1 for target transmission rates more than a threshold (which
only depends on the EVMs of the nodes). Interestingly, this event holds for any channel fading
distribution, any network topology and any transmit SNR. Therefore as explained in Section IV,
some secrecy rates can never be achieved due to secrecy rate ceiling. Furthermore, we conclude
that for target transmission rates smaller than the threshold, Pso approaches zero with increasing
SNR (similar to perfect hardware) whereas the SOP always equals one for target transmission
rates larger than the threshold. This result is fundamentally different to the perfect hardware
case where the SOP goes to zero with increasing SNR and for any target transmission rate [13],
[15], [17].
For Rayleigh fading channels, ?rd is an exponential r.v. and therefore, our new and simple
closed-form SOP expression in the presence of transceiver hardware imperfection is given by
PDLso =
?
??
??
1? exp
(
? (?1?L+?4)R?t
(?L?(?2?L+?3)R?t)?rd
)
;Rt <
1
2
log2
(
1+
?L
?2?L+?3
1+?R
)
1 ;Rt ? 12 log2
(
1+
?L
?2?L+?3
1+?R
) (39)
We note that the results of this section generalize the results of [17] which were derived for the
case of untrusted relaying with perfect hardware.
2) Uplink Scenario: Similar to the DL case, the SOP can be obtained by substituting ?D in
16
(35) into (17) and using the SOP definition. This yields
PULso =
?
????
????
F?sr
(
(?2??1)R?t
1??2(1+
?
1+?2
?1
)R?t
)
;Rt <
1
2
log2
(1+ 1
?2(1+
?
1+?2
?1
)
1+?R
)
1 ;Rt ? 12 log2
(1+ 1
?2(1+
?
1+?2
?1
)
1+?R
)
(40)
where R?t = 2
2Rt(1+?R)?1 and ?R is in (34). For the special case of Rayleigh fading channels,
the closed-form SOP is derived as
PULso =
?
???
???
1? exp
(
?(?2??1)R?t
(1??2(1+
?
1+?2
?1
)R?t)?sr
)
;Rt <
1
2
log2
(1+ 1
?2(1+
?
1+?2
?1
)
1+?R
)
1 ;Rt ? 12 log2
(1+ 1
?2(1+
?
1+?2
?1
)
1+?R
)
(41)
As observed in the numerical results, the closed-form expressions (39) and (41) are sufficiently
tight at medium and high transmit SNRs.
VI. HARDWARE DESIGN
In this section, we aim to gain some insights into the design of RF hardware to maximize the
secrecy rate in untrusted relaying networks. Depending on the fixed cost of each network node,
we show how the RF segments at the transmission and reception front ends can be designed.
Specially, given the maximum tolerable hardware imperfection of each node, we derive new
analytical results characterizing how the hardware imperfections should be distributed between
the transmission RF segment and the reception RF segment of each node to maximize the secrecy
rate. Therefore, we should find kti and k
r
i , i ? {S,R,D} to maximize the secrecy rate such that
kti+k
r
i = k
tot
i . Mathematically speaking, our goal is to solve the following optimization problem
(ktR, k
r
R, k
t
D, k
r
D) = arg max?(?
?) (42)
s.t. ktR + k
r
R = k
tot
R
ktD + k
r
D = k
tot
D
Based on (30), (35) and (17), the instantaneous secrecy rate is an increasing function of the
transmit SNR. Since it is our aim to achieve high transmission rates, we consider the asymptotic
SNR regime ? ? ? [22] to solve the hardware design problem (42). As observed in numerical
studies, the results of the high SNR analysis can be applied successfully at finite SNRs.
17
In the asymptotic SNR regime and for any random distributions on ?sr and ?rd, the asymptotic
received SNDRs at R and D are respectively, given by
??R =
?
??
??
?L
?L(?1?1)+?1 ; DL
1?
?1(1+?2)
; UL
, (43)
and
??D =
?
??
??
?L
?2?L+?3
; DL
1
?2(1+
?
1+?2
?1
)
; UL
. (44)
By substituting (43) and (44) into (18), the secrecy rate ceiling is given by
?? =
?
??
??
((1+?2)?L+?3)((?1?1)?L+?1)
(?1?L+?1)(?2?L+?3)
; DL
?
?1(?2+1)(?2+
?
?1
?
?2+1)
?2(
?
?1+
?
?2+1)(
?
?1
?
?2+1+1)
; UL
(45)
Some conclusions and insights can be concluded from (45). First, the secrecy rate ceiling
event appears in the asymptotic SNR regime, which significantly limits the performance of the
system. This event is different from the perfect hardware case, in which the ESR increases with
increasing SNR. Note that this ceiling effect is independent of the fading distribution.
In the following, we focus on the of DL and UL scenarios separately and then conclude about
the hardware design of the overall network.
A. Downlink Scenario:
In the following, we proceed to solve the optimization problem (42) by independently dis-
cussing on the hardware design at R and D as follows.
Proposition 2: Suppose ktR + k
r
R = k
tot
R , hence the secrecy rate ceiling is maximized if k
t
R =
krR =
ktotR
2
.
Proof: Please see Appendix A.
Proposition 3: Suppose ktD + k
r
D = k
tot
D , thus the secrecy rate ceiling is maximized if
ktD=
2k2R+2k
tot
D
2
+3?
?
4k4R+8k
2
Rk
tot
D
2+4ktotD
4+12k2R?4ktotD 2+9
4ktotD
. (46)
18
Proof: Please see Appendix B.
B. Uplink Scenario:
Similar to DL scenario, two propositions are provided as follows.
Proposition 4: Suppose ktR + k
r
R = k
tot
R , thus the secrecy rate ceiling is maximized if k
t
R =
krR =
ktotR
2
.
Proof: Please see Appendix C.
Proposition 5: Suppose ktD + k
r
D = k
tot
D , hence the secrecy rate ceiling is a monotonically
decreasing function of krD.
Proof: In this case, we have
???
?krD
=
???
??2
??2
?krD
, (47)
where ??2
?krD
= 2krR
2krD+2k
r
D > 0 and
???
??2
in (67) is negative in the feasible set. As such, ??
?
?krD
< 0.
Based on Propositions 2–5, we provide the following corollary as a conclusion of the analysis
which provides new insights into the system design.
Corollary 2: Consider a cooperative network in which one multiple antennas node communi-
cates with a single antenna node via a single antenna untrusted relay. Let us assume a predefined
cost can be assigned to each node. To maximize the secrecy rate of this network the following
considerations should be taken into account:
• According to Propositions 2 and 4, the total cost for the relay node should be divided by
half between the transmission and reception RF front ends, i,e., it is better to apply the same
level of imperfections at every transceiver chain, instead of utilizing a mix of high-quality
and low-quality transceiver chains.
• According to Proposition 5, to design the multiple antennas node, the designers are per-
suaded to use higher-quality hardware in reception RF front end and lower-quality hardware
19
0 5 10 15 20 25 30 35 40 45
0
0.5
1
1.5
2
2.5
3
3.5
4
Transmit SNR [dB]
E
rg
od
ic
 S
ec
re
cy
 R
at
e 
(b
it
s/
s/
H
z)
 
 
LSMA?S, Exact OPA Simulation
LSMA?D, Exact OPA Simulation
LSMA?S, Approximate OPA using eq. (33)
LSMA?D, Approximate OPA using eq. (37)
LSMA?S, EPA
LSMA?D, EPA
Secrecy rate ceiling using eq. (45)
Perfect hardware
Imperfect hardware
Fig. 2. Ergodic secrecy rate versus transmit SNR for exact and the derived closed-form expressions under perfect and imperfect
transceiver hardwares. Number of antennas at source or destination is set to 16. For imperfect case with k = 0.1, the secrecy
rate ceiling is observed.
in the transmission RF front end, i.e, the hardware imperfections at the reception end of
the multiple antennas node should be close to zero.
• According to Proposition 3, to design the single antenna node, the quality of RF requirements
at the transmission end should obeys from (46). As observed in the numerical examples,
we obtain ktD >
ktotD
2
for typical values of EVMs.
VII. NUMERICAL RESULTS AND DISCUSSIONS
In this section, numerical results are provided to verify the accuracy of the derived closed-
form expressions in Section IV and V for LSMA at S (LSMA-S) and LSMA at D (LSMA-D),
respectively, and also the cases of multiple antennas at S (MA-S) and multiple antennas at D
(MA-D). We compare our LSMA-based ESR performance with the exact ESR with Monte-Carlo
simulations where the OPA is numerically evaluated for finite numbers of antennas using the
bisection method. In addition, the equal power allocation (EPA) between S and D (i.e., ? = 0.5)
is plotted as a benchmark. Furthermore, the concepts of secrecy rate ceiling and the practical
hardware insights from Section VI are numerically presented. In our numerical evaluations, the
20
0 5 10 15 20 25 30 35 40 45
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
2.2
2.4
Transmit SNR [dB]
E
rg
od
ic
 S
ec
re
cy
 R
at
e 
(b
it
s/
s/
H
z)
 
 
MA?S, Exact OPA Simulation
MA?D, Exact OPA Simulation
MA?S, Approximate OPA using eq. (33)
MA?D, Approximate OPA using eq. (37)
Case of k=0.05
Case of k=0.1
Fig. 3. Ergodic secrecy rate versus transmit SNR for exact and the derived closed-form expressions under different levels of
hardware imperfections; k ? {0.05, 0.1}. Number of antennas at source or destination is set to 4.
transmission links between nodes are modeled by the Rayleigh fading channel and the average
channel gains are specified as µsr = µrd = 10. Moreover, for LSMA the number of antennas is
set to 16, and for MA the number of antennas is set to 4.
Fig. 2 depicts the ESR versus transmit SNR ? in dB for both cases of DL and UL and for
perfect (k = ktR = k
r
R = k
t
S = k
t
D = k
r
D = 0) and imperfect (k = 0.1) cases. The number of
antennas at S and D are set to Ns = Nd = 16. It is observed from the figure that the Monte-Carlo
simulation of the exact OPA evaluated using the bisection method is in good agreement with
the derived high SNR closed-form solutions in (33) and (37) for both perfect and imperfect
hardwares. In contrast to perfect hardware, the figure shows that the ESR ceiling phenomenon
occurs for imperfect hardware which reveals the performance limits of hardware-constrained
realistic networks in the high SNR regime. This figure also reveals that hardware imperfections
have low impact at low SNRs, but are significant in the high SNR regime. Furthermore, it is
observed that the proposed OPA increases the secrecy rate floor by approximately 1 bits/s/Hz
and 0.9 bits/s/Hz for DL and UL scenarios, respectively compared to the EPA (? = 0.5).
In Fig. 3, we examine the accuracy of the derived closed-form solutions for MA-S and MA-D
by considering Ns = Nd = 4. As can be seen, the numerical and the theoretical curves are in
21
0 5 10 15 20 25 30 35 40
10
?4
10
?3
10
?2
10
?1
10
0
Transmit SNR [dB]
Se
cr
ec
y 
O
ut
ag
e 
Pr
ob
ab
ili
ty
 
 
Imperfect, Exact OPA Simulation
Perfect, Exact OPA Simulation
Imperfect, Approximate OPA using eq. (39)
Perfect, Approximate OPA using eq. (39)
Imperfect, EPA
Perfect, EPA
OPA, R
t
=0.25 bits/s/Hz
EPA, R
t
=0.25 bits/s/Hz
OPA, R
t
=1 bits/s/Hz
OPA, R
t
=2 bits/s/Hz
Fig. 4. Secrecy outage probability versus transmit SNR for DL transmission, with different target transmission rates and under
perfect (k = 0) and imperfect hardware (k = 0.1).
good agreement across all SNR regimes. Moreover, it is observed that by increasing the level
of hardware imperfections from k = 0.05 to k = 0.1, the achievable secrecy rate is degraded
approximately 1 bits/s/Hz in the high SNR regime.
Figs. 4 and 5 show the SOP as a function of the transmit SNR for LSMA based DL and UL
scenarios, respectively, and for different target secrecy rates. The theoretical curves were plotted
by the derived analytical expressions in (39) and (41) which are well-tight with the marker
symbols generated by the Monte-Carlo simulations. As observed from these figures, there is
only a negligible performance loss caused by transceiver hardware imperfections in the low
target secrecy rate of Rt = 0.25 bits/s/Hz, but by increasing the target secrecy rate to Rt = 1
bits/s/Hz or Rt = 2 bits/s/Hz, substantial performance loss is revealed. Interestingly, for Rt = 2
bits/s/Hz, the network with imperfect hardware is always in outage and secure communications is
unattainable-irrespective of the transmit SNR. This is exactly predicted by our analytical results
in section V. The reason is that this target secrecy rate is more than the derived thresholds
in (39) and (41), and as mentioned, the SOP of the system always equals one for Rt more
the thresholds. It can also be seen from the figures that despite the OPA technique that the
SOP curves with imperfect hardware and with perfect hardware have the same slope (and thus,
22
0 5 10 15 20 25 30 35 40
10
?5
10
?4
10
?3
10
?2
10
?1
10
0
Transmit SNR [dB]
Se
cr
ec
y 
O
ut
ag
e 
P
ro
ba
bi
lit
y
 
 
Imperfect, Exact OPA Simulation
Perfect, Exact OPA Simulation
Perfect, Approximate OPA using eq. (41)
Perfect, Approximate OPA using eq. (41)
Imperfect, EPA
Perfect, EPA 
OPA, R
t
=1 bits/s/Hz
OPA, R
t
=2 bits/s/Hz
OPA, R
t
=0.25 bits/s/Hz
EPA, R
t
=0.25 bits/s/Hz
Fig. 5. Secrecy outage probability versus transmit SNR for UL transmission, with different target transmission rates and under
perfect (k = 0) and imperfect hardware (k = 0.1).
hardware imperfections lead to only an SNR offset which is unveiled as a curve shifting to the
right), the SOP performance of the EPA technique approaches a non-zero saturation value in
the high SNR regime for imperfect hardware. This observation reveals the secrecy performance
advantage of the proposed OPA scheme compared with EPA.
Finally, we provide Figs. 6 and 7 to illustrate the insights for designing practical systems that
were presented in Section VI. In the simulation, we assume that the total hardware imperfection
over each node equals to 0.2, i.e., ktotR = k
tot
D = 0.2. Based on Propositions 2 and 4, to maximize
the secrecy rate, we should design the transmission and reception RF front ends at R such that
ktR = k
r
R = 0.1. For LSMA at S, based on Proposition 3, we obtain k
t
D = 0.13 and k
r
D = 0.07
while for LSMA at D and based on Proposition 5, we should design the hardwares such that
ktD = 0.2 and k
r
D = 0. By defining the hardware imperfection vector as IV = [k
t
R, k
r
R, k
t
D, k
r
D],
we consider the following four different hardware design schemes:
• Design 1: R and D are designed randomly, for example IV= [0.15, 0.05, 0.1, 0.1],
• Design 2: R is designed optimally based on Propositions 2 and 4 while D is designed
randomly; IV= [0.1, 0.1, 0.1, 0.1],
• Design 3: R is designed randomly while D is designed optimally; For LSMA at S, IV=
23
0 5 10 15 20 25 30 35 40 45
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
Transmit SNR [dB]
E
rg
od
ic
 S
ec
re
cy
 R
at
e 
(b
its
/s
/H
z)
 
 
OPA, Design 1
OPA, Design 2
OPA, Design 3
OPA, Design 4
EPA, Design 4
Fig. 6. Ergodic secrecy rate versus transmit SNR for LSMA at S. Various imperfection distributions over RF transmission and
reception ends are considered for ktotR = k
tot
D = 0.2.
[0.15, 0.05, 0.13, 0.07] and for LSMA at D, IV= [0.15, 0.05, 0.2, 0], and
• Design 4: R and D are designed optimally; For LSMA at S, IV= [0.1, 0.1, 0.13, 0.07] and
for LSMA at D, IV= [0.1, 0.1, 0.2, 0].
The results depict that the hardware design 4 which is based on Propositions 2-5 provides
higher ESR performance compared to the case of random hardware design (Design 1) and
the cases of optimizing only one node (Designs 2 and 3). Furthermore, they show that the
analysis presented in Section VI (which was based on high SNR analysis), can be utilized
auspiciously at medium SNRs. In addition, as can be seen from these figures and mentioned
before, different hardware designs have the ESR performance close together at low SNR regime,
while the difference between the ESR performance of the designs is large at high SNR regime.
Finally, we can understand from the figure that the proposed OPA together with Design 4
significantly outperforms the scenario of EPA with Design 4.
VIII. CONCLUSION
Physical radio-frequency (RF) transceivers are inseparable segments in both traditional and
new emerging wireless networks. In the literature, very few works have considered the impact
24
0 5 10 15 20 25 30 35 40 45
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
Transmit SNR [dB]
E
rg
od
ic
 S
ec
re
cy
 R
at
e 
(b
it
s/
s/
H
z)
 
 
OPA, Design 1
OPA, Design 2
OPA, Design 3
OPA, Design 4
EPA, Design 4
Fig. 7. Ergodic secrecy rate versus transmit SNR for LSMA at D. Various imperfection distributions over RF transmission and
reception ends are considered for ktotR = k
tot
D = 0.2.
of hardware imperfections on security based transmissions and little is understood regarding
this impact on untrusted relaying networks. In this paper, by taking hardware imperfections
into consideration, we proposed an optimal power allocation (OPA) strategy to maximize the
instantaneous secrecy rate of a cooperative wireless network comprised of a source, a destination
and an untrusted amplify-and-forward (AF) relay. Based on our OPA solutions, new closed-form
expressions were derived for the ergodic secrecy rate (ESR) and secrecy outage probability (SOP)
with Rayleigh fading channels. The expressions effectively characterize the impact of hardware
imperfections and manifest the existence of a secrecy rate ceiling that cannot be enhanced by
increasing SNR or improving fading conditions. They also illustrate that hardware imperfections
have low impact at low SNRs, but are significant in the high SNR regime. This issue reveals that
hardware imperfections should be taken into account when developing high rate systems such as
LTE-Advanced and 5G networks. To improve the secrecy performance of the network, we finally
presented the hardware design approach. Numerical results depict that optimally distributing the
hardware imperfections between the transmission and reception RF segments can further improve
the secrecy performance.
25
APPENDIX A
Let take the first-order derivative of ?? on ktR using the chain rule in partial derivations as
follows
???
?ktR
=
???
??L
(??L
??1
??1
?ktR
+
??L
??2
??2
?ktR
+
??L
??3
??3
?ktR
+
??L
??1
??1
?ktR
)
+
???
??1
??1
?ktR
+
???
??2
??2
?ktR
+
???
??3
??3
?ktR
+
???
??1
??1
?ktR
, (48)
where using (45), we obtain
???
??L
=
?1?L
2 + ?2?L + ?3
(?L?1 + ?1)2(?2?L + ?3)2
, (49)
??L
??1
=
?3
2
?
?2?3 (?1 ? ?3)
, (50)
??L
??2
= ?
?
?3(?1 ? ?3)
2?2
?
?2
? ?3(?1 ? 1)
? 22
, (51)
??L
??3
=
?1 ? 2?3
2
?
?2?3(?1 ? ?3)
+
?1 ? 1
?2
? 1, (52)
??L
??1
=
?3
?2
, (53)
???
??1
=
?L (?2?L + ?3 + ?L)
(?L?1 + ?1)2 (?2?L + ?3)
, (54)
???
??2
= ? ?
2
L(?1?L + ?1 ? ?L)
(?2?L + ?3)2(?1?L + ?1)
, (55)
???
??3
= ? ?L(?1?L + ?1 ? ?L)
(?2?L + ?3)2(?1?L + ?1)
, (56)
???
??1
=
?2L(?2?L + ?3 + ?L)
(?1?L + ?1)2(?2?L + ?3)
, (57)
26
where ?1 = ??1?2(?2 + 1) + ?3?1(?1 ? 1), ?2 = ?2?1?3(?2 ? ?1 + 1) and ?3 = ?1?3(?1 ? ?3). By
substituting krR = k
tot
R ? ktR into (45), we obtain
??1
?ktR
= ?2ktotR + 2ktR, (58)
??2
?ktR
= ?2krD2(ktotR ? ktR)? 2(ktotR ? ktR)ktR
2
+ 2(ktotR ? ktR)2ktR + 4ktR ? 2ktotR , (59)
??3
?ktR
= ?2krD2(ktotR ? ktR)? 2(ktotR ? ktR)ktR
2
+ 2(ktotR ? ktR)2ktR + 4ktR ? 2ktotR + 2ktRktD
2
, (60)
??1
?ktR
= ?2ktotR + 2ktR. (61)
Substituting (49)–(61) into (48) and after tedious manipulations yields
???
?ktR
=
4(1? krD2)(ktotR ? 2ktR)(
4ktR
2 ? 4ktRktotR + 2ktotR 2 + 2krD2 + ktD2
)2 . (62)
Expression (62) shows that ?? is a concave function of ktR in the feasible set and k
t
R =
ktotR
2
is
the single solution to ??
?
?ktR
= 0.
APPENDIX B
Following the similar approach in Proposition 2, we should evaluate ??
?
?ktD
. Let substitute krD =
ktotD ? ktD into ?1, ?2, ?3 and then compute the following derivations
??1
?ktD
= 1,
??2
?ktD
= ?2krR2(ktotD ? ktD)? 2ktotD + 2ktD, (63)
??3
?ktD
= ?2krR2(ktotD ? ktD)? 2ktotD + 2ktD + 2ktD(ktR
2
+ 1) + 2ktD(k
tot
D ? ktD)2 ? 2ktD
2
(ktotD ? ktD).
(64)
The expression ??
?
?ktD
can be obtained similar to (48) by changing ktR to k
t
D. Then by substituting
(49)–(57) and (63), (64) into ??
?
?ktD
, and after manipulations, we obtain
???
?ktD
= ?
2
(
2k2Rk
t
D ? 2ktD2ktotD + 2ktDktotD 2 + 3ktD ? 2ktotD
)
(
2k2R + 3k
t
D
2 ? 4ktDktotD + 2ktotD 2
)2 . (65)
It is straightforward to see that (65) is a concave function of ktD in the feasible set and the single
solution to ??
?
?ktD
= 0 is simply calculated.
27
APPENDIX C
We can write
???
?krR
=
???
??2
??2
?krR
+
???
??1
??1
?krR
. (66)
Using (45) yields
???
??2
= ?
?1
[
(2 (?2+2) ?1??22)
?
?1(1+?2)+2?1(?2(?1+1??2)+?1+1)
]
2?22
(?
?1
?
1+?2+ 1
)2 (
?1+
?
?1
?
1+?2
)2 , (67)
???
??1
=
(1 + ?2)
[
(?2 + 2?1)
?
?1(1 + ?2) + 2 (1 + ?2) ?1
]
2?2
(?
?1
?
1 + ?2 + 1
)2 (
?1 +
?
?1
?
1 + ?2
)2 . (68)
Considering ktR = k
tot
R ? krR, one can obtain
??2
?krR
= 4krR
3 ? 6krR2ktotR + (2krD2 + 2ktotR
2
+ 4)krR ? 2ktotR , (69)
??1
?krR
= 2krR. (70)
By substituting (67)–(70) into (66) and solving ??
?
?krR
= 0 yields krR =
ktotR
2
.
Acknowledgements
The authors would like to thank Prof. Lajos Hanzo for helpful comments to improve the paper.
REFERENCES
[1] A. Mukherjee, S. A. A. Fakoorian, J. Huang, and A. L. Swindlehurst, “Principles of physical-layer security in multiuser
wireless networks: A survey,” IEEE Commun. Surveys and Tutorials, vol. 16, no. 3, pp. 3062-3080, Feb. 2014.
[2] X. Chen, D. W. K. Ng, W. Gerstacker, and H-H. Chen, “A Survey on Multiple-Antenna Techniques for Physical Layer
Security,” IEEE Commun. Surveys Tuts., doi: 10.1109/COMST.2016.2633387.
[3] N. Yang, L. Wang, G. Geraci, M. Elkashlan, J. Yuan, and M. D. Renzo, “Safeguarding 5G wireless communication networks
using physical layer security,” IEEE Commun. Mag., vol. 53, no. 4, pp. 20-27, Apr. 2015.
[4] F. Rusek, D. Persson, B. K. Lau, E. G. Larsson, T. L. Marzetta, O. Edfors, and F. Tufvesson, “Scaling up MIMO:
Opportunities and challenges with very large arrays,” IEEE Sig. Proc. Mag., vol. 30, no. 1, pp. 40-46, Jan. 2013.
[5] E. G. Larsson, F. Tufvesson, O. Edfors, and T. L. Marzetta, “Massive MIMO for next generation wireless systems,” IEEE
Commun. Mag., vol. 52, no. 2, pp. 186-195 , Feb. 2014.
[6] T. L. Marzetta, “Noncooperative cellular wireless with unlimited numbers of BS antennas,” IEEE Trans. Wireless Commun.,
vol. 9, no. 11, pp. 3590-3600, Nov. 2010.
[7] D. Kapetanovic, G. Zheng, and F. Rusek, “Physical layer security for massive MIMO: An overview on passive
eavesdropping and active attacks,” IEEE Commun. Mag., vol. 53, no. 6, pp. 21-27, Jun. 2015.
28
[8] X. He and A. Yener, “Two-hop secure communication using an untrusted relay: A case for cooperative jamming,” in Proc.
IEEE Globecom, New Orleans, LA, Dec. 2008, pp. 15.
[9] M. R. A. Khandaker and K-K Wong, “Masked Beamforming in the Presence of Energy-Harvesting Eavesdroppers,” IEEE
Trans. Inf. Forens. Sec., vol. 10, no. 1, pp. 40-54, Jan. 2015.
[10] M. R. A. Khandaker and K.-K. Wong, “Robust secrecy beamforming in the presence of energy-harvesting eavesdroppers,”
IEEE Wireless Commun. Lett., vol. 4, no. 1, pp. 10-13, Feb. 2015.
[11] Y. Liu, A. P. Petropulu, and H. V. Poor, “Joint decode-and-forward and jamming for wireless physical layer security with
destination assiatance,” in Proc. Asilomar Conference on Signals, Systems and Computer (ASILOMAR11), Pacific Grove,
USA, Nov. 2011.
[12] J. Huang and A. L. Swindlehurst, “Cooperative jamming for secure communications in MIMO relay networks,” IEEE J.
Sel. Areas Commun., vol. 59, no. 10, pp. 4871-4884, Oct. 2011.
[13] J. Huang, A. Mukherjee, and A. L. Swindlehurst, “Secure communication via an untrusted non-regenerative relay in fading
channels,” IEEE Trans. Signal Process., vol. 61, no. 10, pp. 2536-2550, May 2013.
[14] L. Sun, T. Zhang, Y. Li, and H. Niu, “Performance study of two-hop amplify-and-forward systems with untrustworthy
relay nodes,” IEEE Trans. Veh. Technol., vol. 61, no. 8, pp. 3801-3807, Oct. 2012.
[15] W. Wang, K. C. Teh, and K. H. Li, “Secure Cooperative AF Relaying Networks with Untrustworthy Relay Nodes,” in
IEEE Globecom, Washington, DC. 2016, pp. 1-6.
[16] A. Mabrouk, K. Tourki, and N. Hamdi, “Secure cooperative untrusted-relay network with outdated CSI,” in IEEE
International Wireless Communications and Mobile Computing Conference (IWCMC), Paphos, 2016, pp. 90-95.
[17] A. Kuhestani, A. Mohammadi, and M. Noori, “Optimal Power Allocation to Improve Secrecy Performance of Non-
Regenerative Cooperative Systems Using an Untrusted Relay,” IET Commun., vol. 10, no. 8, pp. 962-968, May 2016.
[18] A. Kuhestani, A. Mohammadi, and P. L. Yeoh, “Optimal Power Allocation and Secrecy Sum Rate in Two-Way Untrusted
Relaying,” Submitted to IEEE Trans. Veh. Technol., Apr. 2017.
[19] L. Lv, J. Chen, L. Yang, and Y. Kuo, “Improving physical layer security in untrusted relay networks: cooperative jamming
and power allocation,” IET Commun., vol. 11, no. 3, pp. 393-399, Jul. 2017.
[20] T. Mekkawy, R. Yao, F. Xu, and L. Wang, “Optimal power allocation for achievable secrecy rate in an untrusted relay
network with bounded channel estimation error,” in 26th Wireless and Optical Communication Conference (WOCC),
Newark, NJ, USA, 2017, pp. 1-5.
[21] L. Sun, P. Ren, Q. Du, Y. Wang, and Z. Gao, “Security-Aware Relaying Scheme for Cooperative Networks with Untrusted
Relay Nodes,” IEEE Commun. Lett., vol. 19, no. 3, pp. 463-466, Sep. 2014.
[22] T. Schenk, RF Imperfections in High-Rate Wireless Systems: Impact and Digital Compensation, Springer, 2008.
[23] C. Studer, M. Wenk, and A. Burg, “MIMO transmission with residual transmit-RF impairments,” in Proc. ITG/IEEE
Workshop on Smart Antennas, Feb. 2010.
[24] E. Bjornson, A. Papadogiannis, M. Matthaiou, and M. Debbah, “On the impact of transceiver impairments on AF relaying,”
in Proc. 2013 IEEE Int. Conf. Acoustics, Speech, Signal Process.
[25] A. A. A. Boulogeorgos, D. S. Karas, and G. K. Karagiannidis, “How Much Does I/Q Imbalance Affect Secrecy Capacity?,”
IEEE Commun. Lett., vol. 20, no. 7, pp. 1305-1308, July 2016.
[26] J. Zhu, R. Schober, and V. K. Bhargava, ”Physical Layer Security for Massive MIMO Systems Impaired by Phase Noise,”
IEEE 17th International Workshop on Signal Processing Advances in Wireless Communications, pp. 1-5, Jul. 2016.
[27] J. Zhu, R. Schober and V. K. Bhargava, “Linear Precoding of Data and Artificial Noise in Secure Massive MIMO Systems,”
IEEE Trans. Wireless Commun., vol. 15, no. 3, pp. 2245-2261, Mar. 2016.
29
[28] J. Chen, X. Chen, W. H. Gerstacker and D. W. K. Ng, “Resource Allocation for a Massive MIMO Relay Aided Secure
Communication,” IEEE Trans. Inf. Forens. Sec., vol. 11, no. 8, pp. 1700-1711, Aug. 2016
[29] J. Chen, H. Chen, H. Zhang and F. Zhao, “Spectral-Energy Efficiency Tradeoff in Relay-Aided Massive MIMO Cellular
Networks With Pilot Contamination.,” IEEE Access, vol. 4, no. , pp. 5234-5242, Sept. 2016.
[30] L. Wang, Y. Cai, Y. Zou, W. Yang and L. Hanzo, “Joint Relay and Jammer Selection Improves the Physical Layer Security
in the Face of CSI Feedback Delays,” IEEE Trans. Veh. Technol., vol. 65, no. 8, pp. 6259-6274, Aug. 2016.
[31] B. E. Priyanto, T. B. Sorensen, O. K. Jensen, T. Larsem, T. Kolding, and P. Mogensen, “Assessing and modelling the effect
of RF impairments on UTRA LTE uplink performance,” in Proc. 2007 IEEE Vehic. Techn. Conf. Fall, pp. 12131217.
[32] K. S. Ahn and R. W. Heath, “Performance analysis of maximum ratio combining with imperfect channel estimation in the
presence of cochannel interferences,” IEEE Trans. Wireless Commun., vol. 8, pp. 1080-1085, Mar. 2009.
[33] S. Boyd and L. Vandenberghe, Convex Optimization, Cambridge University Press, 2004.
[34] I. S. Gradshteyn and I. M. Ryzhik, Table of Integrals, Series, and Products, 7th ed. New York: Academic, 2007.
