1
Uplink Non-Orthogonal Multiple Access with
Finite-Alphabet Inputs
Zheng Dong, He Chen, Jian-Kang Zhang, Lei Huang, and Branka Vucetic
Abstract
This paper focuses on the non-orthogonal multiple access (NOMA) design for a classical two-user
multiple access channel (MAC) with finite-alphabet inputs. In contrast to most of existing NOMA designs
using continuous Gaussian input distributions, we consider practical quadrature amplitude modulation
(QAM) constellations at both transmitters, the sizes of which are assumed to be not necessarily identical.
We propose to maximize the minimum Euclidean distance of the received sum-constellation with a
maximum likelihood (ML) detector by adjusting the scaling factors (i.e., instantaneous transmitted
powers and phases) of both users. The formulated problem is a mixed continuous-discrete optimization
problem, which is nontrivial to resolve in general. By carefully observing the structure of the objective
function, we discover that Farey sequence can be applied to tackle the formulated problem. However, the
existing Farey sequence is not applicable when the constellation sizes of the two users are not the same.
Motivated by this, we define a new type of Farey sequence, termed punched Farey sequence. Based
on this, we manage to achieve a closed-form optimal solution to the original problem by first dividing
the entire feasible region into a finite number of Farey intervals and then taking the maximum over all
the possible intervals. The resulting sum-constellation is proved to be a regular QAM constellation of
a larger size, and hence a simple quantization receiver can be implemented as the ML detector for the
demodulation. Moreover, the superiority of NOMA over time-division multiple access (TDMA) in terms
of minimum Euclidean distance is rigorously proved. Furthermore, the optimal rate allocation among
the two users is obtained in closed-form to further maximize the obtained minimum Euclidean distance
of the received signal subject to a total rate constraint. An asymptotic solution is also derived to reveal
more insights on how to allocate the rate to each user. Finally, simulation results are provided to verify
our theoretical analysis and demonstrate the merits of the proposed NOMA over existing orthogonal
and non-orthogonal designs.
Z. Dong is with Shenzhen University, China and he is also with McMaster University, Canada (email: dongz3@mcmaster.ca),
H. Chen and B. Vucetic are with The University of Sydney, Australia (email: {he.chen, branka.vucetic}@sydney.edu.au), J.-K.
Zhang is with McMaster University, Canada (email: jkzhang@mail.ece.mcmaster.ca), Canada, and L. Huang is with Shenzhen
University, China (email: lhuang8sasp@hotmail.com).
ar
X
iv
:1
70
9.
00
50
9v
1 
 [
cs
.I
T
] 
 2
 S
ep
 2
01
7
2
Index Terms
Non-orthogonal multiple access (NOMA), finite-alphabet inputs, multiple access channel (MAC),
quadrature amplitude modulation (QAM), Farey sequence.
I. INTRODUCTION
The forthcoming fifth generation (5G) cellular systems are envisioned to support three generic
services, including extreme mobile broadband (eMBB), massive machine-type communications
(mMTC), and ultra-reliable and low-latency communications (uRLLC) [1], [2]. These diverse
services, driven by the explosive growth of mobile data traffic and expected wide roll-out of
Internet of Things (IoT), pose challenging requirements for the air interface of wireless networks
where enhanced multiple access technologies are essential. Apart from several other poten-
tial technologies such as massive multiple-input multiple-output (MIMO) and millimeter wave
(mmWave) communications, non-orthogonal multiple access (NOMA) has recently emerged
as a key enabling radio access technology to meet these unprecedented requirements of 5G
networks, due to its inherent advantages of high spectral efficiency, massive connectivity, and low
transmission latency [3]–[7]. The concept of NOMA has multiple variants, such as power-domain
NOMA, sparse code multiple access, pattern division multiple access, low density spreading, and
lattice partition multiple access [5]. In this paper, we mainly consider the power-domain NOMA.
The basic principle of NOMA is to serve more than one user with distinct channel conditions
simultaneously in the same orthogonal resource block along the time, frequency, or code axes.
This can be achieved by applying the superposition coding (SC) at the transmitter as well as mul-
tiuser detector (e.g., successive interference cancellation (SIC)) at the receiver side to distinguish
the co-channel users. As such, NOMA is fundamentally different from conventional orthogonal
multiple access (OMA) methods primarily used in the previous generations of mobile systems,
where each user is allocated to one dedicated orthogonal radio resource block exclusively.
This in turn means that, in OMA, multiuser communication can be decomposed into several
parallel single-user ones free of inter-user interference, and then the well-established single-user
encoding/decoding methods can be directly applied with a reasonable tradeoff between network
throughput and implementation complexity [8, Ch. 14].
Although the OMA schemes have been widely used in the past several decades, they generally
cannot achieve the whole multiuser capacity region and thus tend to have a lower spectral
efficiency than NOMA approaches [3], [5], [9], [10]. For example, in OMA, a resource block
3
allocated to a user with a poor channel condition cannot be reused by another user with a much
stronger channel state. Apart from that, OMA is in general not scalable. This is because the
amount of resource blocks as well as the granularity of user scheduling strictly limit the number
of users that can be supported at the same time. On the contrary, by breaking the orthogonality
of the radio resource allocation, NOMA has been shown to be able to provide better user fairness
and improve physical layer security in addition to the advantages mentioned above [3], [5].
A. Related Work
Despite the fact that the deployment of NOMA as a new radio access technology in next-
generation mobile systems is relatively new, the performance of NOMA has been studied exten-
sively in the information theory society for various channel topologies such as broadcast channel
(BC) [11]–[14], multiple access channel (MAC) [15]–[18], and interference channel (IC) [19]–
[23]. However, these results concentrated mainly on the study of the channel capacity region
with the assumption of unlimited encoding/decoding complexity, and therefore lie mostly in the
theoretical aspects due to their extremely high implementation cost. Thanks to the rapid progress
of the radio frequency (RF) chain and the processing capability of mobile devices in the past
decades, the implementation of NOMA is becoming more and more feasible and thus has drawn
tremendous attention from both academia and industry very recently [5]. More specifically, by
taking practical constraints on user fairness and/or radio resource management into consideration,
NOMA has been investigated in various wireless systems, such as cognitive radio [24], [25],
cooperative communications [26], [27], cellular uplink [28], [29], cellular downlink [30]–[34],
and multi-cell networks [35], [36]. In fact, a two-user downlink scenario of NOMA, known
as multiuser superposition transmission (MUST), has already been incorporated in the 3rd
Generation Partnership Project (3GPP) Long Term Evolution-Advanced (LTE-A) [37], [38].
We note that, up to now, the vast majority of existing NOMA designs assumed the use of
Gaussian input signals [6], [11]–[16], [19]–[33], [35]. Although the Gaussian input is of great
significance both theoretically and practically, its implementation in reality will require huge
storage capacity, unaffordable computational complexity and extremely long decoding delay [9,
Ch. 9]. More importantly, the actual transmitted signals in real communication systems are
drawn from finite-alphabet constellations, such as pulse amplitude modulation (PAM), quadrature
amplitude modulation (QAM), and phase-shift keying (PSK) [8, Ch. 5]. Applying the results
4
derived from the Gaussian inputs to the signals with finite-alphabet inputs can lead to significant
performance loss [39]. In this sense, Gaussian input serves mostly as the theoretical benchmark.
Motivated by the above facts, the NOMA design with finite-alphabet inputs is of utmost
importance and has attracted considerable efforts, see e.g., [36], [40]–[44] and references therein.
The main principle1 of these efforts is to ensure that the signal originated from each user can be
uniquely decoded from the received sum-signal at the receiver side. By using mutual information
as a performance measure, references [40], [41] considered the NOMA design in an ideal two-
user Gaussian MAC with finite-input constellations under individual power constraint on each
user. Specifically, NOMA was realized by strategically introducing certain constellation rotations
(CR) to the adopted PSK signals in [40] or using proper power control in [41]. However,
only numerical solutions to the optimal NOMA designs were provided in [40], [41]. Moreover,
linear precoders were considered for the MIMO MAC in [42], where the expression of the
weighted sum-rate was asymptotic and the optimal solution was also numerical. Besides, the
downlink NOMA system with discrete input distributions was studied in [43], where the solution
is intuitive based on the deterministic approximation of the actual fading channel. The discrete
input alphabets were also considered for a two-user interference channel to evaluate the capacity
inner bound in [44]. In other words, all NOMA designs provided in [40]–[44] used mutual
information as the performance measure, where the solutions were numerical and limited insights
on the relationship between the sum-constellation and each user’s constellation can thus be drawn
from the obtained solutions.
B. Motivation and Contributions
Inspired by the aforementioned work, in this paper we target a closed-form NOMA design for a
classical two-user Gaussian MAC with finite-alphabet inputs and an optimal maximum likelihood
(ML) detector at the receiver, where the two users are allowed to transmit simultaneously in the
same frequency band. Finding the capacity bound of a Gaussian MAC with Gaussian inputs
and adaptive power control has always been a classic problem, see e.g., [15]–[18], [22], [23],
[29], [48]; the optimal power control scheme for the Gaussian MAC with finite-alphabet inputs,
however, is still an open problem and only numerical solutions are available [38], [40], [41], [49].
1Note that the principle was originally proposed in the seminal work [45]–[47], wherein the finite-length codeword design
problem in the binary domain were considered from an information-theoretical perspective.
5
To fill this gap, in this paper we, for the first time, investigate the optimal power control problem
for the two-user Gaussian MAC with finite square QAM constellations that maximizes the
minimum Euclidean distance of the received signals with the maximum likelihood (ML) detector.
Note that QAM signaling is more spectrally efficient than other commonly-used constellations
such as PSK signaling. Nevertheless, the NOMA design with QAM is more challenging than
that with PSK since in QAM both the amplitude and the phase of the modulated signal vary,
while in PSK only the phase is different, and thus the unambiguity of the sum-constellation at
the receiver side is much more difficult to maintain. Here, it is worth pointing out that in our
previous work [36], the NOMA design for the Gaussian Z-channel with QAM constellations was
investigated, which incorporates the considered two-user MAC as a special case. In particular,
to resolve the formulated problem, Farey sequence [50] was introduced to characterize the
minimum Euclidean distance of the sum-constellation. However, due to the inherent symmetric
structure between numerators and denominators of the conventional Farey sequence, our results
presented in [36] refer to the case where both transmitters need to use an identical constellation
size implying the same transmission rate. However, the transmission rates of the users are not
necessarily the same in practice due to their distinct quality of service (QoS) requirements. To
our best knowledge, the NOMA design in terms of power control at users for the Gaussian MAC
with not necessarily identical QAM constellations still remains an open problem.
The main contributions of this paper can be summarized as follows:
1) We develop a practical NOMA design for the classical two-user complex Gaussian MAC,
where the two users are allowed to adopt not necessarily the same QAM constellations.
In our design framework, we aim to maximize the minimum Euclidian distance of the
received sum-constellation at the receiver side, which dominates the error performance of
the considered system, by adjusting the transmit power and phase of each user. To this end,
we first decompose the complex MAC design problem into two real MAC design problems
by strategically rotating the phase of the input signals at the two users. Nevertheless,
the decomposed problems are still non-trivial due to their mixed continuous-and-discrete
feature. Furthermore, our Farey sequence-based design framework developed in [36] can
no longer be applied here due to the fact that the two users may use different QAM
constellations.
2) To address this challenging problem, we define a new type of Farey sequence, termed
punched Farey sequence, which is essential for our NOMA design with not necessarily
6
the same QAM constellations. This concept is even mathematically new to the best of
our knowledge [50]. We identify and rigourously prove several important properties of
the punched Farey sequence in parallel to the conventional Farey sequence. Based on the
punched Farey sequence and its important properties, we manage to resolve the above
decomposed problem for each channel branch by providing a neat closed-form optimal
solution, which reveals that the optimal sum-constellation is a regular QAM constellation
of a larger size. Due to this nice structure of the sum-constellation, a simple quantization
decoder can be employed to implement the ML detector.
3) Based on the obtained closed-form solution, we prove the superiority of this NOMA
design over the time-division multiple access (TDMA) approach in terms of the minimum
Euclidean distance at the receiver for arbitrary given channel realization and rate allocation.
Actually, this is a surprising result since the new NOMA method can achieve a better
error performance than TDMA in a high SNR regime even if there is no near-far effect.
Furthermore, we also address the optimal rate-allocation problem among the two users to
maximize the minimum Euclidean distance of the received sum-constellation subject to a
total rate constraint. More importantly, we derive a high-rate approximate solution to the
optimal rate-allocation problem, which uncovers a lot of insights on the practical system
designs.
II. TWO-USER GAUSSIAN MULTIPLE-ACCESS CHANNEL
We consider a two-user Gaussian MAC given by
z = h1x1 + h2x2 + ?, (1)
where z is the received signal at the base station (BS), hk denotes the complex channel coefficient
between the transmitter Sk and BS for k = 1, 2, and ? is the additive zero-mean, circularly
symmetric complex Gaussian (CSCG) noise with variance 2?2, i.e., ? ? CN (0, 2?2). We
assume that perfect channel state information (CSI) is available to all the nodes2 and symbol
synchronization is maintained at BS. The transmitted symbols xk are superimposed at the receiver
in a NOMA manner which are chosen randomly, independently and equally likely from the
2The optimal design can also be performed at the BS which sends the results back to the transmitters via the forward links.
In this case, only BS needs to know the full CSI.
7
(finite) square QAM constellation Qk, and are subject to individual average power constraint
Pk, i.e., E[|xk|2] ? Pk for k = 1, 2.
Although we use a complex baseband representation in (1), the modulated and demodulated
signals are real since the oscillator at the transmitter can only generate real sinusoids rather than
complex exponentials, and the channel then introduces amplitude and phase distortion to the
transmitted signals [8]. As such, we follow [41] to decompose the considered complex Gaussian
MAC given in (1) into two parallel real-scalar Gaussian MACs, which are called the in-phase
and quadrature components, respectively [8]. This means that the original two-dimensional QAM
constellation can be split into two one-dimensional PAM constellations to be transmitted via the
in-phase and quadrature branches. Besides, since the in-phase and quadrature components of
the sum-constellation are separable, they can be decoded independently at the receiver, thereby
reducing the decoding complexity. Mathematically, we notice that (1) is equivalent to
z = |h1|x1 exp(j arg(h1)) + |h2|x2 exp(j arg(h2)) + ?. (2)
To simplify the subsequent expressions, we let y = Re(z), y? = Im(z), w1s1 = Re(x1 exp(j arg(h1))),
w?1s
?
1 = Im(x1 exp(j arg(h1))), w2s2 = Re(x2 exp(j arg(h2))), w
?
2s
?
2 = Im(x2 exp(j arg(h2))),
n = Re(?) and n? = Im(?), where Re(·) and Im(·) are the real and imaginary parts of the
complex number, respectively. Besides, w1, w2, w?1, and w
?
2 are the real non-negative scalars
determining the minimum Euclidean distance of the actual transmitted PAM constellation sets,
which are referred to as the weighting coefficients throughout this paper. Now, the in-phase and
quadrature branches of (1) can be reformulated by
y = |h1|w1s1 + |h2|w2s2 + n, (3a)
y? = |h1|w?1s?1 + |h2|w?2s?2 + n?, (3b)
where n, n? ? N (0, ?2) are independent and identically distributed (i.i.d.) real additive white
Gaussian components since the complex noise term ? is assumed to be CSCG noise.
Without loss of generality, we assume that x1 exp(j arg(h1)) ? Q1 and x2 exp(j arg(h2)) ?
Q2, where Q1 and Q2 are M21 - and M22 -ary square QAM constellations (M1 and M2 are both
no less than 2 but not necessarily equal to each other), respectively, given by Q1 , {±w1(2k?
1) ± w?1(2` ? 1)j : k, ` = 1, . . . ,M1/2} and Q2 , {±w2(2k ? 1) ± w?2(2` ? 1)j : k, ` =
1, . . . ,M2/2}. As a result, the information-bearing symbols s1, s?1 ? AM1 = {±(2k ? 1)}
M1/2
k=1 ,
sent by S1, and s2, s?2 ? AM2 = {±(2k ? 1)}
M2/2
k=1 , transmitted by S2, are drawn from the
8
standard PAM constellations with equal probability. We consider that an equal power allocation
between two branches is performed to balance the minimum Euclidean distance of the two PAM
constellations [8, Ch. 6.1.4] and the transmitted signals over both subchannels should still be
subject to average power constraints, i.e., E[w21|s1|2] ? P1/2, E[w?21 |s?1|2] ? P1/2, E[w22|s2|2] ?
P2/2, and E[w?22 |s?2|2] ? P2/2.
An important problem for the considered MAC is, for any given QAM constellation sizes of
both messages, how to optimize the values of scaling coefficients w1, w2, w?1 and w
?
2 to minimize
the average error probability at the receiver, subject to the individual average power constraints
at both transmitters. As the in-phase and quadrature subchannels are symmetric, if the same
algorithm is applied to both branches, we will expect to have w1 = w?1 and w2 = w
?
2, and
we call Q1 and Q2 the symmetric square QAM constellations. It is worth mentioning that our
framework can be readily extended to un-symmetric signaling [51], [52], i.e., un-equal power
allocation between the two branches. By leveraging the decomposable property of the complex
Gaussian MAC and the symmetry of the two subchannels, we can simply focus on the design for
one of the two real-scalar Gaussian MACs with PAM constellation sets, which will be elaborated
in next section3.
III. THE WEIGHTING COEFFICIENTS DESIGN FOR THE REAL-SCALAR GAUSSIAN MAC
In this section, we consider the constellation design problem, i.e., finding the optimal weighting
coefficients w1 and w2, for the in-phase real-scalar Gaussian MAC. As the two sub-channels are
symmetric, the optimal solution to the quadrature component can be obtained in exactly the
same way and hence is omitted for brevity.
A. Problem Formulation
Recall that E[w21|s1|2] ? P1/2, E[w22|s2|2] ? P2/2, and hence 0 < w1 ?
?
3P1
2(M21?1)
, 0 < w2 ??
3P2
2(M22?1)
. For notation simplicity, we set |h?1| =
?
3P1
2(M21?1)
|h1|, |h?2| =
?
3P2
2(M22?1)
|h2| and
w?1 =
?
2(M21 ? 1)
3P1
w1, w?2 =
?
2(M22 ? 1)
3P2
w2, (4)
3It should be pointed out that designing two PAM constellations for both subchannels separately is a practical but not
necessarily optimal approach. In fact, this approach has been widely adopted in literature, such as in [51]–[56]. How to design
a two-dimensional complex constellation directly for the Gaussian MAC has been left as a future work.
9
where 0 < w?1 ? 1 and 0 < w?2 ? 1. The received signal in (3a) can thus be re-written as
y = |h?1|w?1s1 + |h?2|w?2s2 + n. (5)
We assume that a coherent maximum-likelihood (ML) detector is used by BS to estimate the
transmitted signals in a symbol-by-symbol fashion4. Mathematically, the estimated signals can
be expressed as
(s?1, s?2) = arg min
(s1,s2)
??y ? (|h?1|w?1s1 + |h?2|w?2s2)??.
By applying the nearest neighbour approximation method [8, Ch.6.1.4] at high SNRs for ML
receiver, the average error rate is dominated by the minimum Euclidean distance of the received
constellation points owing to the exponential decaying of the Gaussian distribution. As such, in
this paper, we aim to devise the optimal value of (w?1, w?2) (or equivalently constellations Q1 and
Q2) to maximize the minimum Euclidean distance of constellation points of the received signal.
The Euclidean distance between the two received signals y(s1, s2) and y(s?1, s?2) at the receiver
for (s1, s2) and (s?1, s?2) in the noise-free case is given by
|y(s1, s2)? y(s?1, s?2)| =
??|h?1|w?1(s1 ? s?1)? |h?2|w?2(s?2 ? s2)??. (6)
Note that s1, s?1, s2 and s?2 are all odd numbers, and thus we can let s1?s?1 = 2n and s?2?s2 = 2m,
in which n ? ZM1?1 and m ? ZM2?1 with ZN , {0,±1, · · · ,±N} denoting the set containing
all the possible differences. Similarly, we also define Z2(M1?1,M2?1) , {(a, b) : a ? ZM1?1, b ?
ZM2?1}, and N2(M1?1,M2?1) , {(a, b) : a ? NM1?1, b ? NM2?1} where NN , {0, 1, · · · , N}.
From the definitions above, (s1, s2) 6= (s?1, s?2) is equivalent to (m,n) 6= (0, 0) (i.e., m 6= 0 or
n 6= 0). To proceed, we define
d(m,n) =
1
2
|y(s1, s2)? y(s?1, s?2)|
=
??|h?1|w?1n? |h?2|w?2m??, (m,n) ? Z2(M1?1,M2?1) \ {(0, 0)}, (7)
where A \ B , {x ? A and x /? B}. We are at a point to formally formulate the following
max-min optimization problem,
4Since we perform a symbol-by-symbol detection, the decoding complexity is at most O(M1M2) with M1 and M2 being
the PAM constellation size of s1 and s2, respectively.
10
Problem 1: Power Control of NOMA in real-scalar MAC with PAM constellation: Find the
optimal value of (w??1, w?
?
2) subject to the individual average power constraint such that the
minimum Euclidean distance d? of the received signal constellation points is maximized, i.e.,
(w??1, w?
?
2) = arg max
(w?1,w?2)
min
(m,n)?Z2
(M1?1,M2?1)
\{(0,0)}
d(m,n) (8a)
s.t. 0 < w?1 ? 1 and 0 < w?2 ? 1. (8b)

Note that the inner optimization variable of finding the minimum Euclidean distances is
discrete, while the outer one (w?1, w?2) is continuous. In other words, Problem 1 is a mixed
continuous-discrete optimization problem and it is in general hard to solve. To the best of
our knowledge, only numerical solutions to such kind of problems are available in the open
literature [38], [40], [41], [49]. To optimally and systematically solve this problem, we now
develop a design framework based on the Farey sequence [50], in which the entire feasible
region of (w?1, w?2) is divided into a finite number of mutually exclusive sub-regions. Then, for
each sub-region, the formulated optimization problem can be solved optimally with a closed-
form solution, and subsequently the overall maximum value of Problem 1 can be attained by
taking the maximum value of the objective function among all the possible sub-regions. We first
consider the inner optimization problem in (8) given by:
Problem 2: Finding differential pairs with the minimum Euclidean distance:
min
(m,n)?Z2
(M1?1,M2?1)
\{(0,0)}
d(m,n) = min
(m,n)?Z2
(M1?1,M2?1)
\{(0,0)}
??|h?1|w?1n? |h?2|w?2m??. (9)

We should point out that finding the closed-form solution to the optimal (m,n) for (9) is not
trivial since the solution depends on the values of |h?1| and |h?2|, which can span the whole positive
real axis. Moreover, the values of w?1 and w?2 will be optimized later and cannot be determined
beforehand. It is worth mentioning here that a similar optimization problem was formulated
and resolved for a Gaussian Z channel in our previous work [36]. In [36], we resorted to the
existing Farey sequence to solve the formulated problem. However, due to the inherent symmetric
structure between numerators and denominators of the conventional Farey sequence, our results
presented in [36] refers only to the case where both transmitters need to use exactly identical
constellation size (i.e., the same transmission rate) and thus cannot be applied to the problem in
this paper with M1 and M2 not necessarily the same. Motivated by this, in this paper we define
11
a new type of Farey sequence, termed punched Farey sequence. In the subsequent section, we
will introduce the definition and some important properties of the original Farey sequence and
the developed punched Farey sequence.
B. Farey Sequence
The Farey sequence characterizes the relationship between two positive integers and the formal
definition is given as follows:
Definition 1: Farey sequence [50]: The Farey sequence FK is the ascending sequence of
irreducible fractions between 0 and 1 whose denominators are less than or equal to K. 
By the definition, FK =
(
bk
ak
)|FK |
k=1
is a sequence of fractions bk
ak
such that 0 ? bk ? ak ? K and
?ak, bk? = 1 arranged in an increasing order, where ?a, b? denotes the largest common divider
of non-negative integers a, b. In addition, |FK | = 1+
?K
m=1 ?(m) is the cardinality of FK with
?(·) being the Euler’s totient function [50]. An example of Farey sequence is given as follows:
Example 1: F5 is the ordered sequence
(
0
1
, 1
5
, 1
4
, 1
3
, 2
5
, 1
2
, 3
5
, 2
3
, 3
4
, 4
5
, 1
1
)
.
It can be observed that each Farey sequence begins with number 0 (fraction 0
1
) and ends with
1 (fraction 1
1
). The series of breakpoints after 1
1
is the reciprocal version of the Farey sequence.
We call the Farey sequence together with its reciprocal version as the extended Farey sequence
which is formally defined as follows:
Definition 2: Extended Farey sequence: The extended Farey sequence SK of order K is the
sequence of ascending irreducible fractions, where the maximum value of the numerator and
denominator do not exceed K. 
From the definition, we have SK =
(
bk
ak
)|SK |
k=1
with ?ak, bk? = 1 and |SK | = 1+2
?K
m=1 ?(m).
We have the following example:
Example 2: S5 is the sequence
(
0
1
, 1
5
, 1
4
, 1
3
, 2
5
, 1
2
, 3
5
, 2
3
, 3
4
, 4
5
, 1
1
, 5
4
, 4
3
, 3
2
, 5
3
, 2
1
, 5
2
, 3
1
, 4
1
, 5
1
, 1
0
)
.
It can be observed that the extended Farey sequence starts with number 0 (fraction 0
1
) and
end with ? (fraction 1
0
). We now propose a new definition called Punched Farey sequence in
number theory as follows.
Definition 3: Punched Farey sequence: The punched (extended) Farey sequence PLK is the
ascending sequence of irreducible fractions whose denominators are no greater than K and
numerators are no greater than L. 
Example 3: P25 is the ordered sequence
(
0
1
, 1
5
, 1
4
, 1
3
, 2
5
, 1
2
, 2
3
, 1
1
, 2
1
, 1
0
)
.
12
From Definition 3, when L = K, PKK degenerates into Farey sequence FK , i.e., P
K
K = FK .
We can also observe that each punched Farey sequence begins with number 0 (fraction 0
1
) and
ends with ? (fraction 1
0
).
We now develop some elementary properties of the punched Farey sequence in line with
Farey sequences [50]. It is worth pointing out that, although for some properties, we can find
the counterparts in conventional Farey sequences, the extension to the punched Farey sequences
is non-trivial and the following results are new.
Property 1: If n1
m1
and n2
m2
are two adjacent terms (called Farey pairs) in PLK (min {K,L} ? 2)
such that n1
m1
< n2
m2
, then, 1) n1+n2
m1+m2
?
(
n1
m1
, n2
m2
)
, m1+m2
n1+n2
?
(
m2
n2
, m1
n1
)
; 2) m1n2?m2n1 = 1; 3) If
n1+n2 ? L, then m1+m2 > K and if m1+m2 ? K, then n1+n2 > L; 4) n1+n2 ? 1 where
the equality is attained if and only if n1
m1
= 0
1
and n2
m2
= 1
K
. Likewise, m1 +m2 ? 1 where the
equality is attained if and only if n1
m1
= L
1
and n2
m2
= 1
0
. 
The proof is given in Appendix-A.
Property 2: If n1
m1
, n2
m2
and n3
m3
are three consecutive terms in PLK with min {K,L} ? 2 such
that n1
m1
< n2
m2
< n3
m3
, then n2
m2
= n1+n3
m1+m3
. 
The proof is provided in Appendix-B.
Property 3: Consider n1
m1
, n2
m2
, n3
m3
, n4
m4
? PLK with min {K,L} ? 3, such that n1m1 <
n2
m2
< n3
m3
<
n4
m4
where n2
m2
, n3
m3
are successive in PLK , then
n1+n3
m1+m3
? n2
m2
and n3
m3
? n2+n4
m2+m4
. 
The proof is provided in Appendix-C.
C. The Minimum Euclidean Distance of the Constellation Points of the Received Signal
We are now ready to solve Problem 2 to find the differential pairs (m,n) having the minimum
Euclidean distance. To this end, we first introduce the following preliminary propositions.
Proposition 1: Let F2(M1?1,M2?1) = {(m,n) :
n
m
? PM1?1M2?1}, and then
min
(m,n)?Z2
(M1?1,M2?1)
\{(0,0)}
d(m,n) = min
(m,n)?F2
(M1?1,M2?1)
d(m,n). 
The proof is similar to [36, App.-A] and hence is omitted for brevity.
Proposition 2: Let n1
m1
and n2
m2
be two terms of PM1?1M2?1 such that
n1
m1
< n2
m2
. Then, for |h?2|w?2|h?1|w?1 ?
( n1
m1
, n2
m2
) and d(m,n) =
??|h?1|w?1n? |h?2|w?2m??, we have 1) If |h?2|w?2|h?1|w?1 = n1+n2m1+m2 , then d(m1, n1) =
d(m2, n2); 2) If
|h?2|w?2
|h?1|w?1
?
(
n1
m1
, n1+n2
m1+m2
)
, then d(m1, n1) < d(m2, n2); 3) If
|h?2|w?2
|h?1|w?1
?
(
n1+n2
m1+m2
, n2
m2
)
,
then d(m2, n2) < d(m1, n1). 
The proof can be found in Appendix-D.
13
Proposition 3: For any n1
m1
, n2
m2
, n3
m3
, n4
m4
? PM1?1M2?1 with |P
M1?1
M2?1| ? 4, such that
n1
m1
< n2
m2
<
n3
m3
< n4
m4
, and n2
m2
, n3
m3
are successive in PM1?1M2?1, we have 1) If
|h?2|w?2
|h?1|w?1
? ( n2
m2
, n2+n3
m2+m3
), then
min(m,n)?F2
(M1?1,M2?1)
d(m,n) = d(m2, n2) = |h?2|w?2m2 ? |h?1|w?1n2; 2) If |h?2|w?2|h?1|w?1 ? (
n2+n3
m2+m3
, n3
m3
),
then min(m,n)?F2
(M1?1,M2?1)
d(m,n) = d(m3, n3) = |h?1|w?1n3 ? |h?2|w?2m3. 
The proof is given in Appendix-E.
D. Closed-Form Optimal Solution to Problem 1
With the propositions presented in the previous subsection, we now can solve Problem 1 by
restricting |h?2|w?2|h?1|w?1 into a certain punched Farey interval determined by the corresponding Farey
pair where a closed-form solution is attainable. More specifically, we consider the punched
Farey sequence given by PM1?1M2?1 =
(
b1
a1
, b2
a2
, · · · , bC
aC
)
, where C = |PM1?1M2?1|. Now, assume that
|h?2|w?2
|h?1|w?1
?
(
bk
ak
, bk+1
ak+1
)
where
(
bk
ak
, bk+1
ak+1
)
is the k-th punched Farey interval for k = 1, . . . , C ? 1,
and we aim to find the optimal (w??1(k), w?
?
2(k)) such that
g
( bk
ak
,
bk+1
ak+1
)
= max
(w?1,w?2)
min
(m,n)?F2
(M1?1,M2?1)
d(m,n) (10a)
s.t.
bk
ak
<
|h?2|w?2
|h?1|w?1
? bk+1
ak+1
, 0 < w?1 ? 1 and 0 < w?2 ? 1. (10b)
By applying the propositions in last subsections, we obtained the following lemma related to
the optimal solution to problem (10).
Lemma 1: The optimal solution to (10) is given as follows:
g
( bk
ak
,
bk+1
ak+1
)
=
?????
|h?2|
bk+bk+1
, with (w??1(k), w?
?
2(k)) =
( |h?2|(ak+ak+1)
|h?1|(bk+bk+1)
, 1
)
, if |h?2||h?1|
? bk+bk+1
ak+ak+1
;
|h?1|
ak+ak+1
, with (w??1(k), w?
?
2(k)) =
(
1, |h?1|(bk+bk+1)|h?2|(ak+ak+1)
)
, if |h?2||h?1|
> bk+bk+1
ak+ak+1
.

The proof of Lemma 1 can be found in Appendix-F.
Now, we are ready to present the closed-form optimal solution to Problem 1 in terms of
(w?1, w
?
2) instead of (w?
?
1, w?
?
2) defined in (4) for clarity, which maximizes the minimum Euclidean
distance of the sum-constellation, denoted by dnoma, over the entire feasible region.
14
Theorem 1: Closed-form optimal weighting coefficients: The optimal solution to Problem 1 in
terms of (w?1, w
?
2) is given by:
(w?1, w
?
2) =
???????????????????
(? 3P2M22
2(M22?1)
|h2|
|h1| ,
?
3P2
2(M22?1)
)
, if |h2||h1| ?
?
P1(M22?1)
P2M22 (M
2
1?1)
;(?
3P1
2(M21?1)
,
?
3P1
2M22 (M
2
1?1)
|h1|
|h2|
)
, if
?
P1(M22?1)
P2M22 (M
2
1?1)
< |h2||h1| ?
?
P1M21 (M
2
2?1)
P2M22 (M
2
1?1)
;(?
3P2
2M21 (M
2
2?1)
|h2|
|h1| ,
?
3P2
2(M22?1)
)
, if
?
P1M21 (M
2
2?1)
P2M22 (M
2
1?1)
< |h2||h1| ?
?
P1M21 (M
2
2?1)
P2(M21?1)
;(?
3P1
2(M21?1)
,
?
3P1M21
2(M21?1)
|h1|
|h2|
)
, if
?
P1M21 (M
2
2?1)
P2(M21?1)
< |h2||h1| .
(11)
The resulting minimum Euclidean distance dnoma in each case is:
dnoma =
???????????????????
?
3P2
2(M22?1)
|h2|, if |h2||h1| ?
?
P1(M22?1)
P2M22 (M
2
1?1)
;?
3P1
2M22 (M
2
1?1)
|h1|, if
?
P1(M22?1)
P2M22 (M
2
1?1)
< |h2||h1| ?
?
P1M21 (M
2
2?1)
P2M22 (M
2
1?1)
;?
3P2
2M21 (M
2
2?1)
|h2|, if
?
P1M21 (M
2
2?1)
P2M22 (M
2
1?1)
< |h2||h1| ?
?
P1M21 (M
2
2?1)
P2(M21?1)
;?
3P1
2(M21?1)
|h1|, if
?
P1M21 (M
2
2?1)
P2(M21?1)
< |h2||h1| .
(12)

The proof is provided in Appendix-G.
Remark 1: By combing Eqs. (4) and (11), we can observe that at least one transmitter should
transmit with the maximum power. The principle behind this is that we could always scale
up both users’ transmit powers without violating the power constraint such that the minimum
Euclidean distance is enlarged. 
We have the following remark regarding the choice of constellation size M1,M2.
Remark 2: In order to attain the results in Theorem 1 with the aid of Farey sequence, we
assume that min {M1,M2} ? 2. However, it can be verified that for M1 = 1,M2 ? 2 or
M1 ? 2,M2 = 1, although (11) is no longer true, (12) still holds. In fact, if M1 = 1,M2 ? 2,
we have (w?1, w
?
2) = (0,
?
3P2
2(M22?1)
). Else if M1 ? 2,M2 = 1, we have (w?1, w?2) = (
?
3P1
2(M21?1)
, 0).
That is, by assuming Mk = 1, k = 1, 2, i.e., no information is transmitted by user Sk, we should
let it keep silent, and thus all the channel resources are allocated to the other user exclusively,
who should transmit at its maximum allowable power. 
We also have the following corollary about the optimal solution described in Theorem 1:
Corollary 1: The sum-constellation at the receiver is a standard M21M
2
2 -QAM constellation
with the minimum Euclidean distance dnoma affected by the instantaneous channel realizations
as given in (12). 
15
The proof is provided in Appendix-H.
Due to this nice structure of the sum-constellation, the ML decoder reduces to a simple
quantizer for the complex constellation [34], where the detection can be performed for the in-
phase and quadrature components separately since they are separable. It is worth mentioning that
if |h2||h1| ?
?
P1M21 (M
2
2?1)
P2M22 (M
2
1?1)
, we have |h1|w
?
1
|h2|w?2
= M2, i.e., the constellation of S2 will have a smaller
Euclidean distance than that of S1 at the receiver side; Otherwise if
|h2|
|h1| >
?
P1M21 (M
2
2?1)
P2M22 (M
2
1?1)
, we
attain |h1|w
?
1
|h2|w?2
= 1
M1
, i.e., the constellation of S1 will have a smaller Euclidean distance than that
of S2.
E. The Superiority of NOMA over TDMA
It is significant to conduct comparisons between NOMA and OMA, such as in [57]. Now,
to facilitate this comparison of NOMA over OMA with finite-alphabet inputs, we compare
the minimum Euclidean distance of the proposed NOMA and that of TDMA under the same
channel realization. In general, for TDMA, the overall available frame is partitioned uniformly
into orthogonal time slots of the same length for the ease of symbol synchronization. Specifically,
for a two-user TDMA, we assume that each user has half of the total available time slots and
therefore, they should employ M21 - and M
2
2 -ary PAM constellations, respectively, to maintain
the same transmission rate. In this comparison, we also assume that the channel state of both
users remains unchanged (i.e., quasi-static) during the two consecutive time slots.
For TDMA, the minimum Euclidean distance for users S1 and S2 are doma,1 =
?
3P1
2(M41?1)
|h1|
and doma,2 =
?
3P2
2(M42?1)
|h2|, respectively. Now, we denote the minimum Euclidean distance
among the two users as:
doma = min {doma,1, doma,2} = min
{? 3P1
2(M41 ? 1)
|h1|,
?
3P2
2(M42 ? 1)
|h2|
}
. (13)
We then have the following corollary regarding the resulting minimum Euclidean distance of
both schemes:
Corollary 2: The minimum Euclidean distance of the proposed NOMA, dnoma given in (12), is
strictly larger than that of the TDMA scheme, doma given in (13), with equal time-slot allocation.
That is, dnoma > doma holds for arbitrary given channel realizations h1, h2 and constellation sizes
M1, M2. 
16
The proof is provided in Appendix-I. From Corollary 2, since dnoma > doma, it is expected
that NOMA outperforms TDMA in terms of error performance, especially in moderate and high
SNR regions as can be confirmed by numerical results.
IV. RATE ALLOCATION IN TWO-USER GAUSSIAN MAC WITH SUM-RATE CONSTRAINT
In this section, we consider the optimal rate-allocation problem among the two users under
a sum-rate constraint for the above two-user Gaussian MAC with a finite PAM constellation.
Moreover, a high-rate asymptotically optimal solution is also provided when the transmission
rates of both users are relatively high.
A. Problem Formulation
From a radio resource management perspective, when user fairness is not a major concern,
one of the most important problems is to maximize the minimum Euclidean distance at the
receiver side, which determines the system error performance in moderate and high SNR regimes.
This motivates us to consider the maximization of dnoma in (12) under a sum-rate constraint.
Mathematically speaking, we intend to solve the following optimization problem:
Problem 3: Rate allocation in two-user MAC under a sum-rate constraint: We aim to maximize
the minimum Euclidean distance of the received sum-constellation dnoma given in (12) by
adjusting the constellation sizes of both users under a sum-rate constraint, that is:
max
M1,M2
dnoma s.t. log2M1 + log2M2 = log2M, (14)
where M is the size of the sum-constellation, and log2M1, log2M2 ? Nlog2M (i.e., M1, M2 are
non-negative integer powers of 2). 
B. Optimal Rate Allocation
In this subsection, we investigate the above rate-allocation problem. From (14), we have
M2 = M/M1, and therefore the minimum distance dnoma can be considered as a piecewise
function of M1 for any given ? =
P2|h2|2
P1|h1|2 . Note that, in (14), the channel coefficients |h1|, |h2|
and power constraints P1, P2 are treated as constant, and thus ? is also considered as a known
17
constant. Then, Problem 3 is equivalent to the minimization of ?(M1) =
3P1|h1|2
2d2noma
and with the
help of (12), we can attain:
?(M1) =
???????????????????
1
?
(
M2
M21
? 1
)
, if 1 ?M1 ? ?1(?);
M2 ? M2
M21
, if ?1(?) < M1 ? ?2(?);
1
?
(M2 ?M21 ), if ?2(?) < M1 ? ?3(?);
M21 ? 1, if ?3(?) < M1 ?M,
(15)
where ?1(?) =
?
?+1
?+ 1
M2
, ?2(?) =
??
(??1)2+ 4?
M2
?(??1)
2
M , and ?3(?) =
?
?+M2
?+1
.
From (15), we can find that, ?(M1) is monotonically decreasing for 1 ? M1 ? ?1(?) and
?2(?) < M1 ? ?3(?), and it is monotonically increasing for ?1(?) < M1 ? ?2(?) and ?3(?) <
M1 ?M . Consequently, the optimal rate-allocation solution can be stated as follows:
Theorem 2: The optimal solution to Problem 3 is M?1 = M1,(k?) and M
?
2 = M/M
?
1 such that
k? = argmin ?k, in which ?1 = 1?
(
M2
M2
1,(1)
? 1
)
, where M1,(1) = 2blog2 ?1(?)c;
?2 =
?????
M2 ? M2
M2
1,(2)
, if blog2 ?1(?)c ? blog2 ?2(?)c+ 1
?, otherwise
, where M1,(2) = 2
blog2 ?1(?)c+1;
?3 =
?????
1
?
(M2 ?M21,(3)), if blog2 ?2(?)c ? blog2 ?3(?)c+ 1
?, otherwise
, where M1,(3) = 2
blog2 ?3(?)c;
and ?4 =M21,(4)? 1, where M1,(4) = 2blog2 ?3(?)c+1, where bac is the floor function which returns
the largest integer no more than a. 
Although the above solution is optimal, the structure of the sum-constellation as a function of
? is not straightforward enough. In the following part, we will give an asymptotically optimal
solution to draw some useful insights and also reveal the merits of the proposed NOMA scheme.
C. Asymptotically Optimal Solution when the Transmission Rates of Both Users Are High
For the considered two-user system, the most interesting case is when the transmission rates
of both users go to infinity [54], [58]. In a such case, we have limM1??
M21?1
M21
= 1 and
18
limM2??
M22?1
M22
= 1 and then ?(M1) in (15) will converge to ??(M?1), such that:
??(M?1) =
???????????????????
M2
?M?21
, if 1 ? M?1 ? 1?? ;
M2, if 1 ? 1?
?
< M?1 ?M ;
M2
?
, if 1
M
? M?1
M
? 1?
?
< 1;
M?21 , if
1?
?
< M?1
M
? 1.
(16)
Problem 4 (Asymptotically optimal rate-allocation problem in MAC under a sum-rate con-
straint): We intend to solve the following optimization problem by adjusting M?1 and M?2 subject
to a sum-rate constraint, given by:
min
M?1,M?2
??(M?1) s.t. log2 M?1 + log2 M?2 = log2M, (17)
where ??(M?1) is defined in (16), and M?1, M?2 are powers of 2. 
Since the objective function is a simple piecewise function of M?1, we are ready to formally
give our solutions with no need of proof:
Theorem 3: Asymptotically optimal solution: The asymptotically optimal solution to Problem 4
is given by:
1) If ? ? 1, we have M??1 = min {2
blog2 1?? c+1,M} and M??2 = MM??1 ;
2) If ? > 1, we have M??1 = max {2
blog2 M?? c, 1} and M?2 = MM??1 . 
We have the following remark on the asymptotically optimal solution:
Remark 3: We consider the case in a high SNR regime and with near-far effect such that
1
2
log(1 + P1|h1|
2
2?2
) 1
2
log(1 + P2|h2|
2
2?2
) 1. We then have the following two cases:
• Case 1: The sum-rate is relatively low such that M2 ? 1
?
: In this case, with Theorem 3, we
have M??1 = min {2
blog2 1?? c+1,M} =M and M??2 =M/M??1 = 1. In other words, the channel
should be solely allocated to the user with stronger channel, and our scheme degrades into
the OMA method with the resulting minimum Euclidean distance dnoma =
?
3P1
2M2
|h1|.
• Case 2: The sum-rate is high enough such that M2 > 1
?
: Likewise, by Theorem 3, we have
M??1 = min {2
blog2 1?? c+1,M} = 2blog2
1?
?
c+1 ? 1?
?
=
?
P1|h1|?
P2|h2|
and M??2 =M/M?
?
1 ?
?
P2|h2|?
P1|h1|
M .
Now, by (12), we can attain dnoma =
?
3P1
2M??22 (M?
?2
1 ?1)
|h1|?
?
3P1
2M2
|h1|.
Overall, for the proposed NOMA design in a high SNR regime and with near-far effect, if the
sum-rate is low, the weak user should keep silent and the channel resources are solely allocated to
the user with a stronger channel. On the other hand, if the sum-rate is high enough, the minimum
19
0 10 20 30 40 50 60 70 80 90 100
10?4
10?3
10?2
10?1
100
SNR (dB)
BE
R
 
 
Proposed?NOMA
FDMA
TDMA
CR?NOMA
(a)
0 10 20 30 40 50 60 70 80 90 100
10?4
10?3
10?2
10?1
100
SNR (dB)
BE
R
 
 
Proposed?NOMA
FDMA
TDMA
CR?NOMA
(b)
Fig. 1. Comparison between the Proposed-NOMA, CR-NOMA, TDMA and FDMA methods where 64-QAM is used for our
case and 64-PSK is used for CR-based method: (a) (?21 , ?22) = (1, 1), (b) (?21 , ?22) = (1, 1/64).
Euclidean distance of the proposed NOMA design is close to that when only the strong user
transmits free of interference. This means that in our scheme, the support of the weak user to
transmit at a non-zero rate together with the strong user will cause almost no degradation to the
system performance. But, the rate of the weak user highly depends on the near-far effect.
V. SIMULATION RESULTS AND DISCUSSIONS
In this section, we carry out computer simulations to verify the effectiveness of our NOMA
design relative to the CR-NOMA design proposed in [40] and the OMA methods including
TDMA and frequency-division multiple access (FDMA) schemes in various channel conditions
and system configurations. More specifically, we consider both cases where the transmission rates
are fixed or adaptive to channel states. Without loss of generality, we assume that P1 = P2 = 1
and the system signal-to-noise ratio (SNR) is defined by ? , 1/2?2. All channels are subject to
Rayleigh fading such that hk ? CN (0, 2?2k), k = 1, 2.
A. Comparison of Average Error Performance with Fixed Transmission Rate
We first consider the case where the transmission rates of both users are predetermined,
i.e., the constellation sizes M21 and M
2
2 are fixed. For convenience, we assume that both users
transmit alternatively by using half of the total time slots or half of the available frequency band
in TDMA and FDMA, respectively. In both methods, to maintain the same data rate for each
user, we should increase the constellation sizes by using M41 - and M
4
2 -ary QAM constellations
20
instead. There is no interference occurring at the receiver side since the channels are orthogonal
to each other. It is worth mentioning that, for both TDMA and FDMA, we assume that the
instantaneous transmit power of each user remains the same as in the NOMA. For FDMA
method, as the total bandwidth of each user is halved, the equivalent noise at the receiver side
also reduces by half compared with the TDMA method. Therefore, we would expect the FDMA
scheme has an around 3dB SNR gain compared with TDMA method. For the CR-NOMA, we
let each user transmit at the maximum allowable power by using constellations
{
exp( j2?k
N
)
}N?1
k=0
and
{
exp( j2?k+j?
N
)
}N?1
k=0
as proposed in [40] for users S1 and S2, respectively.
We first compare the average BER of all the schemes where the variances of the channel
coefficients are the same, i.e., (?21, ?
2
2) = (1, 1) in Fig. 1(a). In the simulation, without loss of
generality, we assume that each user adopts 64-QAM for the proposed NOMA design and 64-
PSK is used by each user in CR-NOMA. Meanwhile, for TDMA and FDMA methods, each
user uses 4096-QAM. As can be observed from Fig. 1(a) that, the proposed NOMA design
outperforms all the designs in moderate and high SNR regimes. In addition, the FDMA method
has a better error performance than the TDMA scheme as expected. The CR-NOMA has the
highest BER due to the fact that the PSK constellation has a smaller Euclidean distance under
the same power constraint compared with QAM constellation.
In the following simulation, we take the near-far effect into consideration by letting (?21, ?
2
2) =
(1, 1/64) as shown in Fig. 1(b). Likewise, the proposed NOMA design has the lowest BER
compared with all the benchmark schemes. Also, we can observe that the gap between the
proposed NOMA and the FDMA as well as TDMA is larger than that in the case of equal
channel gain. For example, at the BER 10?3, the proposed NOMA has around 5dB SNR gain in
Fig. 1(a), while the SNR gain is approximately 10dB in Fig. 1(b). Interestingly, we also observe
that the error performance of CR-NOMA improves substantially compared to TDMA and FDMA
in this case with near-far effect.
From both Figs. 1(a) and 1(b), we can observe that the performance gain of NOMA is highly
related to the relative strength of the channel coefficients. To show this phenomenon clearly,
we now study the BER against the relative strength of the channel coefficients under different
SNRs. More specifically, in Fig.2(a), we set the variance of user S1 as ?21 = 1, and we plot the
BER against the variance of user S2, i.e., ?22 , in dB. It can be observed from Fig. 2(a) that, for
? = 40dB (i.e., the SNR is relatively low relative to the target transmission rate), our proposed
NOMA scheme outperforms all the benchmark schemes. When ?22 is less than 1 (i.e., less than
21
?10 ?5 0 5 10 15 20 25 30 35
10?4
10?3
10?2
10?1
100
?2
2 (dB)
BE
R
 
 
Proposed?NOMA
FDMA
TDMA
CR?NOMA
(a)
?10 ?5 0 5 10 15 20 25 30 35
10?5
10?4
10?3
10?2
10?1
?2
2 (dB)
BE
R
 
 
Proposed?NOMA
FDMA
TDMA
CR?NOMA
(b)
Fig. 2. Comparison between the Proposed-NOMA with CR-NOMA, TDMA, and FDMA methods, 64-QAM are used for our
case and 64-PSK are used for CR based method with (a) ? = 40dB. (b) ? = 50dB.
0dB), the error performance is mainly limited by user S1 and even if ?22 equals to 1, the BER
gain of the proposed NOMA method is still marginal. However, with the increase of ?22 , the
BER gain of the proposed NOMA method increases and finally gets saturated. Actually, when
?22 is extremely large, the BER of the proposed NOMA is close to the system with one user
transmitting with 64-QAM in both orthogonal blocks, while for the OMA method, it saturates
as one user transmits using 4096-QAM in one block. This validates our observation that the
proposed NOMA has a higher SNR gain when there is near-far effect. With the increase of ?22 ,
the performance of CR-NOMA improves dramatically and it eventually outperforms the OMA
methods. However, the BER performance is poor when the channel gains of the two users are
close. This is due to the fact that with the same spectral efficiency, a PSK constellation has a
smaller minimum Euclidean distance than a QAM constellation. Moreover, the sum-constellation
of two PSK constellations at the receiver does not have a good geometric structure,In Fig. 2(b),
we can see that with the near-far effect, the BER gain of the proposed NOMA also become more
significant. The BER gain of the proposed NOMA is evident even if ?22 = 1, which coincides
well with the phenomenon observed in Fig. 1.
B. Comparison of Average Error Performance with Optimal Rate Allocation
We now compare the average error performance of our proposed NOMA using the optimal rate
allocation (see Sec. IV) with that of all the benchmark schemes. Note that for TDMA and FDMA,
22
0 10 20 30 40 50 60 70
10?4
10?3
10?2
10?1
100
SNR (dB)
BE
R
 
 
Proposed?NOMA
Proposed?NOMA, asymptotic
FDMA
TDMA
(a)
0 10 20 30 40 50 60 70
10?4
10?3
10?2
10?1
100
SNR (dB)
BE
R
 
 
Proposed?NOMA
Proposed?NOMA, asymptotic
FDMA
TDMA
(b)
Fig. 3. Comparison between proposed-NOMA, TDD and FDD methods, 64-QAM are used with M = 64. (a) (?21 , ?22) = (1, 1),
(b) (?21 , ?22) = (1, 1/64).
0
2
4
6
?20?10
010
20
0
0.05
0.1
0.15
0.2
log2 (M1)
20 log10(|h2|)
Eu
cli
de
an
 d
ist
an
ce
?1 0 1
?101   Proposed?NOMATDMA
(a)
0
2
4
6
8
?20
?10
0
10
20
0
0.01
0.02
0.03
0.04
0.05
log2 (M1)
20 log10(|h2|)
Eu
cli
de
an
 d
ist
an
ce
  
Proposed?NOMA
TDMA
(b)
Fig. 4. Comparison of the minimum Euclidean distance of the proposed-NOMA (i.e., dnoma given in (12)) and that of TDMA
method (doma given in (13)) with |h1| = 1 for different |h2| and M1 (a) M = 64, (b) M = 256.
we should find the optimal values of M1 and M2 satisfying M =M1M2, to maximize doma given
in (13). Without loss of generality, we set M = 64 and we consider both cases without and with
near-far effect as plotted in Figs 3(a) and 3(b), respectively. As shown and explained in [27], the
superiority of NOMA over OMA can be reduced when both of them adopt the optimal resource
allocation. Here, we make similar observations by comparing Fig. 3 with Fig. 1. Nevertheless,
as showed in Fig. 3, NOMA yields a considerable performance gain compared to OMA even
they both employ the optimal resource allocation, and this gain can further be enlarged by the
near-far effect. For example, at the BER of 10?3, the proposed NOMA has about 3dB SNR gain
23
without near-far effect, which increases to 5dB with near-far effect. Moreover, we observe that
the performance achieved by the asymptotically optimal rate allocation tightly approaches that
of the optimal rate allocation solution, which validates our analysis in Sec. IV-C.
C. Comparison of the Minimum Euclidean Distance
At last, we compare the minimum Euclidean distance of the proposed NOMA design with
that of TDMA method in Fig. 4. It can be observed that our proposed NOMA design achieves
larger minimum Euclidean distance than TDMA method in all simulated cases, which validates
the result presented in Corollary 2. We can also see that the stronger the near-far effect is, the
larger the performance gap between the proposed NOMA and TDMA. More importantly, for
the proposed NOMA, when we enlarge M1, there is a large interval in which the minimum
Euclidean distance of NOMA (i.e., dnoma) will remain almost unchanged, while that of TDMA
only has one peak among the considered range of M1. This indicates that the proposed NOMA
has a larger degree of freedom in adaptive rate allocation than that of TDMA under the condition
of causing nearly no degradation of system error performance.
VI. CONCLUSIONS
In this paper, we have presented a practical design framework for the non-orthogonal multiple
access (NOMA) scheme in a classical two-user multiple access channel (MAC) with quadrature
amplitude modulation (QAM) constellations at both users, the sizes of which are not necessarily
the same. More specifically, we aimed to maximize the minimum Euclidean distance of the sum-
constellation at the receiver by adjusting the instantaneous transmit power and phase of each user
under an individual average power constraint. The design objective was formulated into a mixed
continuous-discrete optimization problem. By introducing a new mathematical concept termed
punched Farey sequence and investigating its fundamental properties, we managed to attain a
compact closed-form solution. Based on the obtained solution, an adaptive rate allocation was
performed to further maximize the minimum Euclidean distance of the received sum-constellation
under a sum-rate constraint; a high-rate asymptotic approximation solution was also proposed
to extract more insights on the NOMA design. Computer simulations were conducted to verify
our derivation under various channel configurations, and the simulation results demonstrated
that our proposed NOMA scheme outperforms OMA and existing NOMA significantly and the
performance gap can be further enlarged when there is a near-far effect between the users.
24
APPENDIX
A. Proof of Property 1
1) We first prove that n1
m1
< n1+n2
m1+m2
, which can be showed by calculating n1+n2
m1+m2
? n1
m1
=
m1n2?m2n1
m1(m1+m2)
> 0, since n1
m1
< n2
m2
. The rest cases can be proved in a similar fashion and hence are
omitted.
2) We now prove that m1n2?m2n1 = 1 and it also gives the construction of the term which
succeeds n1
m1
in PLK . First of all, since ?m1, n1? = 1, the following equation
m1n?mn1 = 1 (18)
has integer solutions in m,n such that m = m0 + rm1, n = n0 + rn1 for any integer r, where
m0, n0 is a particular set of solutions to (18) and ?m,n? = 1 [50, Thm. 25]. As n1m1 ? P
L
K , we
have 0 ? n1 ? L and 0 ? m1 ? K. Then, we can choose m,n satisfying either condition:
Case 1 : K ?m1 < m ? K, and 0 < n ? L; (19a)
Case 2 : 0 < m ? K ?m1, and L? n1 < n ? L. (19b)
Now, since n
m
is in its lowest terms (i.e., ?m,n? = 1), and for either case we have 0 < m ? K,
0 < n ? L, we conclude that n
m
is a fraction of PLK . In what follows, we will show that either
Case 1 or 2 will generate the next term which comes after n1
m1
in PLK .
Case 1: From (18), n
m
= n1
m1
+ 1
m1m
> n1
m1
, hence n
m
comes after n1
m1
in PLK . Then, if
n
m
is not
n2
m2
, it will come after n2
m2
, and then
n2
m2
? n1
m1
=
m1n2 ?m2n1
m1m2
? 1
m1m2
;
n
m
? n2
m2
=
m2n?mn2
m2m
? 1
m2m
. (20)
As a result, by jointly considering (18) and (20), we have 1
m1m
(a)
= m1n?mn1
m1m
= n
m
? n1
m1
=
n
m
? n2
m2
+ n2
m2
? n1
m1
(b)
? 1
m2m
+ 1
m1m2
= m1+m
m1m2m
(c)
> K
m1m2m
(d)
? 1
m1m
, where (a) follows from (18);
inequality (b) holds since (20); inequality (c) follows from (19a) and (d) is true since n2
m2
? PLK .
This is a contradiction, and therefore n
m
must be n2
m2
, and hence m1n2 ?m2n1 = 1.
Case 2: As in Case 1, according to (18), n
m
= n1
m1
+ 1
m1m
> n1
m1
, and hence n
m
comes after n1
m1
in PLK . As a result, if
n
m
is not n2
m2
, it comes after n2
m2
, and we have
m1
n1
? m2
n2
=
m1n2 ?m2n1
n1n2
? 1
n1n2
;
m2
n2
? m
n
=
m2n?mn2
n2n
? 1
n2n
. (21)
Likewise, we conclude that 1
n1n
(a)
= m1n?mn1
n1n
= m1
n1
? m
n
= m1
n1
? m2
n2
+ m2
n2
? m
n
(b)
? 1
n1n2
+ 1
n2n
=
n+n1
n1n2n
(c)
> L
n1n2n
(d)
? 1
n1n
, where (a) follows from (18), inequality (b) holds as a result of (21), and
25
inequality (c) follows from (19b), and (d) is true since n2
m2
? PLK . There is also a contradiction,
therefore n
m
must be n2
m2
, and thus m1n2 ? m2n1 = 1. 3) From the above proof, i.e., (19a)
and (19b), we can observe that: (a) If n1 + n2 ? L, then m1 +m2 > K; (b) If m1 +m2 ? K,
then n1 + n2 > L.
4) From (19a) and (19b), we can observe that, m1+m2 > 0 (i.e., m1+m2 ? 1) and n1+n2 > 0
(i.e., n1 + n2 ? 1). First, we consider the case n1m1 =
0
1
. As n1 = 0, then by solving (18) of
Case 1 in the above discussion, we have n2 = 1. By (19a), we attain K ? 1 < m2 ? K, i.e.,
m2 = K. Now, we attain two adjacent terms n1m1 =
0
1
and n2
m2
= 1
K
such that n1 + n2 = 1
and m1 + m2 = K + 1. Similarly, we can find adjacent terms n1m1 =
L
1
an n2
m2
= 1
0
such that
m1 +m2 = 1 and n1 + n2 = L+ 1.
This completes the proof of Property 1. 
B. Proof of Property 2
By Property 1, we have m1n2 ?m2n1 = 1, m2n3 ?m3n2 = 1. Then, solving the following
equations: m3m1n2 ? m3m2n1 = m3, m1m2n3 ? m1m3n2 = m1, n3m1n2 ? n3m2n1 = n3,
n1m2n3?n1m3n2 = n1, for m2, n2, we attain m2(m1n3?m3n1) = m1+m3, n2(m1n3?m3n1) =
n1 + n3. As m1n3 ?m3n1 6= 0, we have n2m2 =
n1+n3
m1+m3
. The property is proved. 
C. Proof of Property 3
From the assumption, we have n2
m2
? n1+n3
m1+m3
= m1n2+m3n2?m2n1?m2n3
m2(m1+m3)
= m1n2?m2n1?1
m2(m1+m2)
? 0;
n2+n4
m2+m4
? n3
m3
= m3n2+m3n4?m2n3?m4n3
m3(m2+m4)
= m3n4?m4n3?1
m3(m2+m4)
? 0. The completes the proof. 
D. Proof of Proposition 2
Recall that d(m,n) =
??|h?1|w?1n ? |h?2|w?2m??. Therefore, for |h?2|w?2|h?1|w?1 ? ( n1m1 , n2m2 ), we have
d(m1, n1) ? d(m2, n2) =
??|h?1|w?1n1 ? |h?2|w?2m1?? ? ??|h?1|w?1n2 ? |h?2|w?2m2?? = ?|h?1|w?1n1 +
|h?2|w?2m1?|h?1|w?1n2+|h?2|w?2m2 = (m1+m2)|h?1|w?1
(
|h?2|w?2
|h?1|w?1
? n1+n2
m1+m2
)
. The results in Proposition 2
can be readily obtained, and we complete the proof. 
E. Proof of of Proposition 3
Proof: As n1
m1
and n4
m4
are arbitrarily chosen, Proposition 3 is equivalent to
1) If |h?2|w?2|h?1|w?1 ?
(
n2
m2
, n2+n3
m2+m3
)
, then d(m2, n2) < d(m3, n3), d(m2, n2) < d(m4, n4), and d(m2, n2) <
d(m1, n1);
26
2) If |h?2|w?2|h?1|w?1 ?
(
n2+n3
m2+m3
, n3
m3
)
, then d(m3, n3) < d(m2, n2), d(m3, n3) < d(m1, n1), and d(m3, n3) <
d(m4, n4).
First, by Proposition 2, we have
1) If |h?2|w?2|h?1|w?1 ?
(
n2
m2
, n2+n3
m2+m3
)
, then d(m2, n2) < d(m3, n3) and d(m2, n2) < d(m4, n4);
2) If |h?2|w?2|h?1|w?1 ?
(
n2+n3
m2+m3
, n3
m3
)
, then d(m3, n3) < d(m1, n1) and d(m3, n3) < d(m2, n2).
Then, we want to show that:
1) If |h?2|w?2|h?1|w?1 ?
(
n2
m2
, n2+n3
m2+m3
)
, then d(m2, n2) < d(m1, n1);
2) If |h?2|w?2|h?1|w?1 ?
(
n2+n3
m2+m3
, n3
m3
)
, then d(m3, n3) < d(m4, n4).
The first case can be proved by considering d(m1, n1)? d(m2, n2) =
??|h?1|w?1n1 ? |h?2|w?2m1?????|h?1|w?1n2 ? |h?2|w?2m2?? = |h?1|w?1( |h?2|w2|h?1|w1 (m1 ?m2)? (n1 ? n2)). As |h?2|w?2|h?1|w?1 ? ( n2m2 , n2+n3m2+m3 ), then
d(m1, n1) ? d(m2, n2) ? 0 is true if n2m2 (m1 ?m2) ? (n1 ? n2) ? 0 and
n2+n3
m2+m3
(m1 ?m2) ?
(n1 ? n2) ? 0. We know that n2m2 (m1 ? m2) ? (n1 ? n2) =
(
m1n2 ? m2n1
)
/m2 > 0, and
n2+n3
m2+m3
(m1 ?m2) ? (n1 ? n2) =
(
(n2 + n3)(m1 ?m2) ? (m2 +m3)(n1 ? n2)
)
/(m2 +m3) =(
(m1 +m3)n2 ?m2(n1 + n3) +m1n3 ?m3n1
)
/(m2 +m3) > 0, where the inequality is always
true by Property 3.
Likewise, the second case can be proved by considering d(m4, n4)?d(m3, n3) =
??|h?1|w?1n4?
|h?2|w?2m4
?? ? ??|h?1|w?1n3 ? |h?2|w?2m3?? = |h?1|w?1( |h?2|w?2|h?1|w?1 (m3 ? m4) ? (n3 ? n4)). As |h?2|w?2|h?1|w?1 ?(
n2+n3
m2+m3
, n3
m3
)
, then d(m4, n4) ? d(m3, n3) ? 0 is true if n3m3 (m3 ? m4) ? (n3 ? n4) ? 0 and
n2+n3
m2+m3
(m3 ? m4) ? (n3 ? n4) ? 0. We know that n3m3 (m3 ? m4) ? (n3 ? n4) =
(
n3(m3 ?
m4) ? m3(n3 ? n4)
)
/m3 = (m3n4 ? m4n3)/m3 > 0, and n2+n3m2+m3 (m3 ? m4) ? (n3 ? n4) =(
(n2 + n3)(m3 ?m4) ? (m2 +m3)(n3 ? n4)
)
/(m2 +m3) =
(
m3(n2 + n4) ? n3(m2 +m4) +
m2n4?m4n2
)
/(m2+m3) > 0, where the inequality is always true by Property 3. We complete
the proof. 
F. Proof of Lemma 1
According to proposition 3 and notice that
(
bk
ak
, bk+1
ak+1
)
=
(
bk
ak
, bk+bk+1
ak+ak+1
)
?
( bk+bk+1
ak+ak+1
, bk+1
ak+1
)
,
problem in (10) can be further divided into the following two sub-problems, and the overall
solution is the maximum value of the two problems:
27
Problem 5 (Sub-problem 1): The optimization problem is stated as follows:
g1
( bk
ak
,
bk+1
ak+1
)
= max
(w?1,w?2)
|h?2|w?2ak ? |h?1|w?1bk (22a)
s.t.
bk
ak
? |h?2|w?2
|h?1|w?1
<
bk + bk+1
ak + ak+1
, 0 < w?1 ? 1, 0 < w?2 ? 1. (22b)

Problem 6 (Sub-problem 2): We aim to solve the following optimization problem:
g2
( bk
ak
,
bk+1
ak+1
)
= max
(w?1,w?2)
|h?1|w?1bk+1 ? |h?2|w?2ak+1 (23a)
s.t.
bk + bk+1
ak + ak+1
? |h?2|w?2
|h?1|w?1
? bk+1
ak+1
, 0 < w?1 ? 1, 0 < w?2 ? 1. (23b)

We know that (22) is equivalent to
g1
( bk
ak
,
bk+1
ak+1
)
= max
(w1,w2)
|h?2|w?2ak ? |h?1|w?1bk (24a)
s.t.
|h?2|(ak + ak+1)
|h?1|(bk + bk+1)
w?2 < w?1 ?
ak|h?2|
bk|h?1|
w?2, 0 < w?1 ? 1, 0 < w?2 ? 1. (24b)
We can find that the objective function is a linear decreasing function of w?1. Then, we let
w?1 =
|h?2|(ak+ak+1)
|h?1|(bk+bk+1)
w?2, and the objective function can be reformulated by |h?2|w?2ak ? |h?1|w?1bk =(
ak(bk+ bk+1)? bk(ak+ ak+1)
) |h?2|w?2
bk+bk+1
(a)
= |h?2|w?2
bk+bk+1
, where (a) follows from Property 1. Now, the
constraints on w?2 are 0 < w?2 ? 1, 0 < w?2 ? |h?1|(bk+bk+1)|h?2|(ak+ak+1) . Therefore, the solution to (22) can
be given as follows:
g1
( bk
ak
,
bk+1
ak+1
)
=
?????
|h?2|
bk+bk+1
, with (w?1, w?2) = (
|h?2|(ak+ak+1)
|h?1|(bk+bk+1)
, 1), if |h?2||h?1|
? bk+bk+1
ak+ak+1
;
|h?1|
ak+ak+1
, with (w?1, w?2) = (1,
|h?1|(bk+bk+1)
|h?2|(ak+ak+1)
), if |h?2||h?1|
> bk+bk+1
ak+ak+1
.
(25)
Likewise, we note that (23) is equivalent to
g2
( bk
ak
,
bk+1
ak+1
)
= max
(w?1,w?2)
|h?1|w?1bk+1 ? |h?2|w?2ak+1 (26a)
s.t.
(bk + bk+1)|h?1|
(ak + ak+1)|h?2|
w?1 ? w?2 ?
bk+1|h?1|
ak+1|h?2|
w?1, 0 < w?1 ? 1, 0 < w?2 ? 1. (26b)
By letting w?2 =
(bk+bk+1)|h?1|
(ak+ak+1)|h?2|
w?1, the objective function can be reformulated by |h?1|w?1bk+1 ?
|h?2|w?2ak+1 =
(
bk+1(ak + ak+1)? ak+1(bk + bk+1)
) |h?1|w?1
ak+ak+1
= |h?1|w?1
ak+ak+1
. The constraints on w?1 are
0 < w?1 ? 1 and 0 < w?1 < (ak+ak+1)|h2|(bk+bk+1)|h?1| . Thus, we have
g2
( bk
ak
,
bk+1
ak+1
)
=
?????
|h?2|
bk+bk+1
, with (w?1, w?2) = (
|h?2|(ak+ak+1)
|h?1|(bk+bk+1)
, 1), if |h?2||h?1|
? bk+bk+1
ak+ak+1
;
|h?1|
ak+ak+1
with (w?1, w?2) = (1,
|h?1|(bk+bk+1)
|h?2|(ak+ak+1)
), if |h?2||h?1|
> bk+bk+1
ak+ak+1
.
(27)
28
Combining the two cases, we have the result in Lemma 1, and we complete the proof. 
G. Proof of Theorem 1
Consider the punched Farey sequence PM1?1M2?1 =
(
b1
a1
, b2
a2
, · · · , bC
aC
)
, where C = |PM1?1M2?1|. We
consider each case separately as follows:
1) If |h?2||h?1| ?
1
M2
, we have |h?2||h?1| ?
1
M2
= b1+b2
a1+a2
? bk+bk+1
ak+ak+1
, k = 1, . . . , C?1. By Lemma 1, for each
Farey interval, we can attain that g
(
bk
ak
, bk+1
ak+1
)
= |h?2|
bk+bk+1
, for k = 1, . . . , C?1. As a consequence,
the minimum Euclidean distance d? can be attained by taking the maximum value of the objective
function over all the possible intervals, given by: d? = max
{
|h?2|
b1+b2
, . . . , |h?2|
bC?1+bC
}
= |h?2|
b1+b2
= |h?2|,
where the optimality is attained when (w??1, w?
?
2) = (M2
|h?2|
|h?1|
, 1) with the help of Property 1, and
hence |h?1|w?
?
1
|h?2|w??2
=M2.
2) If 1
M2
< |h?2||h?1|
? M1
M2
, we can suppose that b`1+b`1+1
a`1+a`1+1
< |h?2||h?1|
? b`1+1+b`1+2
a`1+1+a`1+2
, where `1 can be
determined upon the knowledge of |h?2||h?1| . Then, with the help of Lemma 1, we have
g
( bk
ak
,
bk+1
ak+1
)
=
?????
|h?1|
ak+ak+1
, k = 1, . . . , `1;
|h?2|
bk+bk+1
, k = `1 + 1, . . . , C ? 1.
First, for ak+ak+1, k = 1, . . . , `1, we have the following two cases: (a) If ak+ak+1 ?M2, then
we have 1
ak+ak+1
? 1
M2
; (b) If ak + ak+1 < M2 (i.e., ak + ak+1 ? M2 ? 1), then by Property 1,
we have bk + bk+1 ? M1 (i.e., bk + bk+1 > M1 ? 1). From the assumption, we have bk+bk+1ak+ak+1 ?
b`1+b`1+1
a`1+a`1+1
< |h?2||h?1|
? M1
M2
. Therefore, we have 1
ak+ak+1
? M1
M2(bk+bk+1)
? 1
M2
. Combining the above
two cases, we have
1
ak + ak+1
? 1
M2
, k = 1, . . . , `1. (28)
Next, consider bk + bk+1, k = `1 + 1, . . . , C ? 1 and we can show that: (a) If bk + bk+1 < M1
(i.e., bk+bk+1 ?M1?1), then by Property 1, we have ak+ak+1 ?M2 (i.e., ak+ak+1 > M2?1).
As a consequence, we have |h?2||h?1| ?
b`1+1+b`1+2
a`1+1+a`1+2
? bk+bk+1
ak+ak+1
? bk+bk+1
M2
; (b) If bk + bk+1 ?M1, then
we have |h?2||h?1| ?
M1
M2
? bk+bk+1
M2
. Combining both cases, we have
|h?1|
M2
? |h?2|
bk + bk+1
, k = `1 + 1, . . . , C ? 1. (29)
Now, with the help of (28) and (29), the overall minimum Euclidean distance is given by d? =
max
{ |h?1|
a1+a2
, . . . , |h?1|
a`1+a`1+1
, |h?2|
b`1+1+b`1+2
, . . . , |h?2|
bC?1+bC
}
= max
{ |h?1|
M2
, |h?2|
b`1+1+b`1+2
, . . . , |h?2|
bC?1+bC
}
=
29
|h?1|
M2
, where the optimality is attained when (w??1, w?
?
2) = (1,
|h?1|
M2|h?2|
) and as a result we have
|h?1|w??1
|h?2|w??2
=M2.
3) If M1
M2
< |h?2||h?1|
? M1, we can suppose that
b`2+b`2+1
a`2+a`2+1
? |h?2||h?1| <
b`2+1+b`2+2
a`2+1+a`2+2
. With the help of
Lemma 1, we have
g
( bk
ak
,
bk+1
ak+1
)
=
?????
|h?1|
ak+ak+1
, k = 1, . . . , `2;
|h?2|
bk+bk+1
, k = `2 + 1, . . . , C ? 1.
We first show that, for bk + bk+1, k = `2 + 1, . . . , C ? 1, (a) If bk + bk+1 ? M1, then we
have 1
bk+bk+1
? 1
M1
; (b) If bk + bk+1 < M1, then by Property 1, we have ak + ak+1 ?M2. From
the assumption, we have bk+bk+1
ak+ak+1
? b`2+1+b`2+2
a`2+1+a`2+2
> |h?2||h?1|
> M1
M2
. Therefore, we have 1
bk+bk+1
<
M2
M1(ak+ak+1)
? 1
M1
. By jointly considering both cases, we have
1
bk + bk+1
? 1
M1
, for k = `2 + 1, . . . , C ? 1. (30)
Next, we consider ak + ak+1, k = 1, . . . , `2, (a) If ak + ak+1 < M2, then by Property 1, we have
bk + bk+1 ?M1; As a result, M1ak+ak+1 ?
bk+bk+1
ak+ak+1
? b`2+b`2+1
a`2+a`2+1
? |h?2||h?1| . (b) If ak + ak+1 ?M2, then
M1
ak+ak+1
? M1
M2
< |h?2||h?1|
. Combining both cases, we conclude that
|h?1|
ak + ak+1
? |h?2|
M1
, k = 1, . . . , `2. (31)
Therefore, with the help of (30) and (31), the overall minimum Euclidean distance is d? =
max
{ |h?1|
a1+a2
, . . . , |h?1|
a`2+a`2+1
, |h?2|
b`2+1+b`2+2
, . . . , |h?2|
bC?1+bC
}
= max
{ |h?1|
a1+a2
, . . . , |h?1|
a`2+a`2+1
, |h?2|
M1
}
= |h?2|
M1
,
where the optimality is attained when (w??1, w?
?
2) =
( |h?2|
M1|h?1|
, 1
)
and as a result, d? = |h?2|
M1
and
|h?1|w??1
|h?2|w??2
= 1
M1
.
4) If M1 <
|h?2|
|h?1|
, then bk+bk+1
ak+ak+1
? M1 < |h?2||h?1| , for k = 1, . . . , C ? 1. By using Lemma 1,
g
(
bk
ak
, bk+1
ak+1
)
= |h?1|
ak+ak+1
for k = 1, . . . , C ? 1, and d? = max
{
|h?1|
a1+a2
, . . . , |h?1|
aC?1+aC
}
= |h?1|
aC?1+aC
=
|h?1|, where the optimality is attained when (w?1, w?2) = (1,M1 |h?1||h?2|) with the help of Property 1,
and as a result, |h?1|w?
?
1
|h?2|w??2
= 1
M1
.
The solution to Problem 1 can be summarized as
• If |h?2||h?1| ?
1
M2
, then (w??1, w?
?
2) =
(
M2
|h?2|
|h?1|
, 1
)
, d? = |h?2|, and |h?1|w?
?
1
|h?2|w??2
=M2;
• If 1
M2
< |h?2||h?1|
? M1
M2
, then (w??1, w?
?
2) =
(
1, |h?1|
M2|h?2|
)
, d? = |h?1|
M2
, and |h?1|w?
?
1
|h?2|w??2
=M2;
• If M1
M2
< |h?2||h?1|
?M1, then (w??1, w??2) =
( |h?2|
M1|h?1|
, 1
)
, d? = |h?2|
M1
, and |h?1|w?
?
1
|h?2|w??2
= 1
M1
;
• If M1 <
|h?2|
|h?1|
, then (w??1, w?
?
2) =
(
1,M1
|h?1|
|h?2|
)
, d? = |h?1|, and |h?1|w?
?
1
|h?2|w??2
= 1
M1
.
30
From the previous assumption, we know that w?1 =
?
2(M21?1)
3P1
w1, w?2 =
?
2(M22?1)
3P2
w2, |h?1| =?
3P1
2(M21?1)
|h1|, and |h?2| =
?
3P2
2(M22?1)
|h2|. After some algebraic manipulations, the conclusion in
Theorem 1 can be readily obtained and we complete the proof of the theorem. 
H. Proof of Corollary 1
Without loss of generality, we consider |h2||h1| ?
?
P1(M22?1)
P2M22 (M
2
1?1)
, and therefore |h1|w?1s1 +
|h2|w?2s2 =
?
3P2M22
2(M22?1)
|h2|
|h1| |h1|s1 +
?
3P2
2(M22?1)
|h2|s2 =
?
3P2
2(M22?1)
|h2|(M2s1 + s2). Recall that
s1 ? AM1 = {±(2k ? 1)}
M1/2
k=1 and s2 ? AM2 = {±(2k ? 1)}
M2/2
k=1 , and therefore M2s1 + s2 ?
AM1M2 = {±(2k?1)}
M1M2/2
k=1 . The quadrature component of the sum-constellation is identical to
that of the in-phase component. Hence, the sum-constellation is an M21M
2
2 -QAM constellation
with a minimum Euclidean distance dnoma. The case
|h2|
|h1| >
?
P1(M22?1)
P2M22 (M
2
1?1)
can be proved in a
similar manner and hence is omitted for brevity. 
I. Proof of Corollary 2
Recall that dnoma and doma given in (12) and (13), respectively. We consider the following
cases one by one as follows:
1) If M
2
2 (M
2
1?1)
M22?1
? P1|h1|
2
P2|h2|2 , we have dnoma =
?
3P2
2(M22?1)
|h2|, and then dnomadoma,2 =
?
M22 + 1 > 1.
2) If M
2
2 (M
2
1?1)
M21 (M
2
2?1)
? P1|h1|
2
P2|h2|2 <
M22 (M
2
1?1)
M22?1
, we attain dnoma =
?
3P1
2M22 (M
2
1?1)
|h1| and then we
consider the following two scenarios: (a) For M2 ? M1, we conclude dnomadoma,1 =
?
M21+1
M22
> 1;
(b) For M2 > M1, we attain dnomadoma,2 =
?
P1|h1|2(M42?1)
P2|h2|2M22 (M21?1)
. As P1|h1|
2
P2|h2|2 ?
M22 (M
2
1?1)
M21 (M
2
2?1)
, we attain
dnoma
doma,2
?
?
M22+1
M21
> 1.
3) If M
2
1?1
M21 (M
2
2?1)
? P1|h1|
2
P2|h2|2 <
M22 (M
2
1?1)
M21 (M
2
2?1)
, we have dnoma =
?
3P2|h2|2
2M21 (M
2
2?1)
. Likewise, we consider
the following two scenarios: (a) For M1 ? M2, then dnomadoma,2 =
?
M22+1
M21
> 1. (b) For M1 > M2,
then dnoma
doma,1
=
?
P2|h2|2(M41?1)
P1|h1|2M21 (M22?1)
. As P1|h1|
2
P2|h2|2 <
M22 (M
2
1?1)
M21 (M
2
2?1)
, we have dnoma
doma,1
>
?
M21+1
M22
> 1.
4) If P1|h1|
2
P2|h2|2 <
M21?1
M21 (M
2
2?1)
, we attain
?
3P1
2(M21?1)
|h1|, and hence dnomadoma,1 =
?
M21 + 1 > 1.
From the above discussion, we can conclude that dnoma > doma and this completes the proof. 
REFERENCES
[1] H. Tullberg, P. Popovski, Z. Li, M. A. Uusitalo, A. Hoglund, O. Bulakci, M. Fallgren, and J. F. Monserrat, “The METIS
5G system concept: Meeting the 5G requirements,” IEEE Commun. Mag., vol. 54, pp. 132–139, Dec. 2016.
[2] S. Y. Lien, S. L. Shieh, Y. Huang, B. Su, Y. L. Hsu, and H. Y. Wei, “5G new radio: Waveform, frame structure, multiple
access, and initial access,” IEEE Commun. Mag., vol. 55, no. 6, pp. 64–71, 2017.
31
[3] L. Dai, B. Wang, Y. Yuan, S. Han, C. l. I, and Z. Wang, “Non-orthogonal multiple access for 5G: solutions, challenges,
opportunities, and future research trends,” IEEE Commun. Mag., vol. 53, pp. 74–81, Sept. 2015.
[4] Z. Ding, Y. Liu, J. Choi, Q. Sun, M. Elkashlan, C. L. I, and H. V. Poor, “Application of non-orthogonal multiple access
in LTE and 5G networks,” IEEE Commun. Mag., vol. 55, pp. 185–191, Feb. 2017.
[5] Z. Ding, X. Lei, G. K. Karagiannidis, R. Schober, J. Yuan, and V. Bhargava, “A survey on non-orthogonal multiple access
for 5G networks: Research challenges and future trends,” IEEE J. Sel. Areas Commun., vol. PP, no. 99, pp. 1–1, 2017.
[6] P. Wang, J. Xiao, and L. P, “Comparison of orthogonal and non-orthogonal approaches to future wireless cellular systems,”
IEEE Veh. Technol. Mag., vol. 1, pp. 4–11, Sept. 2006.
[7] Q. C. Li, H. Niu, A. T. Papathanassiou, and G. Wu, “5G network capacity: Key elements and technologies,” IEEE Veh.
Technol. Mag., vol. 9, pp. 71–78, Mar. 2014.
[8] A. Goldsmith, Wireless Communications. Cambridge University Press, 2005.
[9] T. M. Cover and J. A. Thomas, Elements of Information Theory. Wiley-Interscience, 2nd ed., 2006.
[10] A. E. Gamal and Y.-H. Kim, Network Information Theory. Cambridge Univ. Press, 2012.
[11] T. Cover, “Broadcast channels,” IEEE Trans. Inf. Theory, vol. 18, pp. 2–14, Jan. 1972.
[12] P. Bergmans, “Random coding theorem for broadcast channels with degraded components,” IEEE Trans. Inf. Theory,
vol. 19, pp. 197–207, Mar. 1973.
[13] T. Cover, “Comments on broadcast channels,” IRE Trans. Inf. Theory, vol. 44, pp. 2524–2530, Oct. 1998.
[14] G. Caire and S. Shamai, “On the achievable throughput of a multiantenna Gaussian broadcast channel,” IEEE Trans. Inf.
Theory, vol. 49, pp. 1691–1706, July 2003.
[15] D. Slepian and J. K. Wolf, “A coding theorem for multiple access channels with correlated sources,” Bell Syst. Tech. J.,
vol. 52, pp. 1037–1076, Sept. 1973.
[16] R. S. Cheng and S. Verdu, “Gaussian multiaccess channels with ISI: capacity region and multiuser water-filling,” IEEE
Trans. Inf. Theory, vol. 39, pp. 773–785, May 1993.
[17] D. N. C. Tse and S. V. Hanly, “Multiaccess fading channels. I. polymatroid structure, optimal resource allocation and
throughput capacities,” IEEE Trans. Inf. Theory, vol. 44, pp. 2796–2815, Nov. 1998.
[18] S. V. Hanly and D. N. C. Tse, “Multiaccess fading channels. II. delay-limited capacities,” IEEE Trans. Inf. Theory, vol. 44,
pp. 2816–2831, Nov 1998.
[19] A. Carleial, “A case where interference does not reduce capacity,” IEEE Trans. Inf. Theory, vol. 21, pp. 569–570, Sept.
1975.
[20] A. Carleial, “Interference channels,” IEEE Trans. Inf. Theory, vol. 24, pp. 60–70, Jan. 1978.
[21] T. S. Han and K. Kobayashi, “A new achievable rate region for the interference channel,” IEEE Trans. Inf. Theory, vol. 27,
pp. 49–60, Jan. 1981.
[22] A. Wyner, “Recent results in the shannon theory,” IEEE Trans. Inf. Theory, vol. 20, pp. 2–10, Jan. 1974.
[23] E. van der Meulen, “A survey of multi-way channels in information theory: 1961-1976,” IEEE Trans. Inf. Theory, vol. 23,
pp. 1–37, Jan. 1977.
[24] Z. Ding, P. Fan, and H. V. Poor, “Impact of user pairing on 5G nonorthogonal multiple-access downlink transmissions,”
IEEE Trans. Veh. Technol., vol. 65, pp. 6010–6023, Aug. 2016.
[25] Y. Liu, Z. Ding, M. Elkashlan, and J. Yuan, “Nonorthogonal multiple access in large-scale underlay cognitive radio
networks,” IEEE Trans. Veh. Technol., vol. 65, pp. 10152–10157, Dec. 2016.
[26] Z. Ding, M. Peng, and H. V. Poor, “Cooperative non-orthogonal multiple access in 5G systems,” IEEE Commun. Lett.,
vol. 19, pp. 1462–1465, Aug. 2015.
32
[27] Z. Ding, H. Dai, and H. V. Poor, “Relay selection for cooperative NOMA,” IEEE Wireless Commun. Lett., vol. 5, pp. 416–
419, Aug. 2016.
[28] Z. Ding, Z. Yang, P. Fan, and H. V. Poor, “On the performance of non-orthogonal multiple access in 5G systems with
randomly deployed users,” IEEE Signal Process. Lett., vol. 21, pp. 1501–1505, Dec. 2014.
[29] N. Zhang, J. Wang, G. Kang, and Y. Liu, “Uplink nonorthogonal multiple access in 5G systems,” IEEE Commun. Lett.,
vol. 20, pp. 458–461, Mar. 2016.
[30] Y. Saito, A. Benjebbour, Y. Kishiyama, and T. Nakamura, “System-level performance evaluation of downlink non-orthogonal
multiple access (NOMA),” in Proc. IEEE Personal Indoor and Mobile Radio Commun. (PIMRC’13), pp. 611–615, Sept.
2013.
[31] Y. Saito, Y. Kishiyama, A. Benjebbour, T. Nakamura, A. Li, and K. Higuchi, “Non-orthogonal multiple access (NOMA)
for cellular future radio access,” in Proc. IEEE 77th Vehi. Tech. Conf. (VTC Spring’13), pp. 1–5, June 2013.
[32] A. Benjebbovu, A. Li, Y. Saito, Y. Kishiyama, A. Harada, and T. Nakamura, “System-level performance of downlink
NOMA for future LTE enhancements,” in Proc. Globecom Workshops (GC Wkshps’13), pp. 66–70, Dec. 2013.
[33] Z. Ding, L. Dai, and H. V. Poor, “MIMO-NOMA design for small packet transmission in the Internet of things,” IEEE
Access, vol. 4, pp. 1393–1405, 2016.
[34] Z. Dong, Y. Y. Zhang, J. K. Zhang, and X. C. Gao, “Quadrature amplitude modulation division for multiuser MISO
broadcast channels,” IEEE J. Sel. Topics Signal Process., vol. 10, pp. 1551–1566, Dec. 2016.
[35] W. Shin, M. Vaezi, B. Lee, D. J. Love, J. Lee, and H. V. Poor, “Non-orthogonal multiple access in multi-cell networks:
Theory, performance, and practical challenges,” CoRR, vol. abs/1611.01607, 2016.
[36] Z. Dong, H. Chen, J. K. Zhang, and L. Huang, “On non-orthogonal multiple access with finite-alphabet inputs in Z-
channels,” IEEE J. Sel. Areas Commun., no. 99, 2017.
[37] 3rd Generation Partnership Project (3GPP), “Study on downlink multiuser superposition transmission (MUST) for LTE
(release 13),” 3GPP TR 36.859 V13.0.0, Dec. 2015.
[38] H. Lee, S. Kim, and J. H. Lim, “Multiuser superposition transmission (MUST) for LTE-A systems,” in Proc. IEEE Int.
Conf. Commun. (ICC’16), pp. 1–6, May 2016.
[39] A. Lozano, A. M. Tulino, and S. Verdu, “Optimum power allocation for parallel Gaussian channels with arbitrary input
distributions,” IEEE Trans. Inf. Theory, vol. 52, pp. 3033–3051, July 2006.
[40] J. Harshan and B. Rajan, “On two-user Gaussian multiple access channels with finite input constellations,” IEEE Trans.
Inf. Theory, vol. 57, pp. 1299–1327, Mar. 2011.
[41] J. Harshan and B. S. Rajan, “A novel power allocation scheme for two-user GMAC with finite input constellations,” IEEE
Trans. Wireless Commun., vol. 12, pp. 818–827, Feb. 2013.
[42] Y. Wu, C. K. Wen, C. Xiao, X. Gao, and R. Schober, “Linear precoding for the MIMO multiple access channel with finite
alphabet inputs and statistical CSI,” IEEE Trans. Wireless Commun., vol. 14, pp. 983–997, Feb 2015.
[43] S. L. Shieh and Y. C. Huang, “A simple scheme for realizing the promised gains of downlink nonorthogonal multiple
access,” IEEE Trans. Commun., vol. 64, pp. 1624–1635, April 2016.
[44] A. Dytso, D. Tuninetti, and N. Devroye, “On the two-user interference channel with lack of knowledge of the interference
codebook at one receiver,” IEEE Trans. Inf. Theory, vol. 61, pp. 1257–1276, Mar. 2015.
[45] T. Kasami and S. Lin, “Coding for a multiple-access channel,” IEEE Trans. Inf. Theory, vol. 22, pp. 129–137, Mar. 1976.
[46] T. Kasami and S. Lin, “Bounds on the achievable rates of block coding for a memoryless multiple-access channel,” IEEE
Trans. Inf. Theory, vol. 24, pp. 187–197, Mar. 1978.
[47] R. Ahlswede and V. Balakirsky, “Construction of uniquely decodable codes for the two-user binary adder channel,” IEEE
Trans. Inf. Theory, vol. 45, pp. 326–330, Jan. 1999.
33
[48] M. Al-Imari, P. Xiao, M. A. Imran, and R. Tafazolli, “Uplink non-orthogonal multiple access for 5G wireless networks,”
in n Proc. 11th Int. Symp. on Wireless Commun. Syst. (ISWCS’14), pp. 781–785, Aug. 2014.
[49] X. Xiao, Q. Huang, and E. Viterbo, “Joint optimization scheme and sum constellation distribution for multi-user Gaussian
multiple access channels with finite input constellations,” in Proc. 2016 Australian Commu. Theory Workshop (AusCTW),
pp. 130–135, Jan. 2016.
[50] G. Hardy and E. Wright, An Introduction to the Theory of Numbers. Oxford Univ. Press, 4 ed., 1975.
[51] S. Lagen, A. Agustin, and J. Vidal, “On the superiority of improper Gaussian signaling in wireless interference MIMO
scenarios,” IEEE Trans. Commun., vol. 64, pp. 3350–3368, Aug. 2016.
[52] V. R. Cadambe, S. A. Jafar, and C. Wang, “Interference alignment with asymmetric complex signaling: Settling the Høst-
Madsen-Nosratinia conjecture,” IEEE Trans. Inf. Theory, vol. 56, pp. 4552–4565, Sept 2010.
[53] V. R. Cadambe and S. A. Jafar, “Interference alignment and degrees of freedom of the K-user interference channel,” IEEE
Trans. Inf. Theory, vol. 54, pp. 3425–3441, Aug. 2008.
[54] R. H. Etkin, D. Tse, and H. Wang, “Gaussian interference channel capacity to within one bit,” IEEE Trans. Inf. Theory,
vol. 54, pp. 5534–5562, Dec. 2008.
[55] G. Bresler, A. Parekh, and D. Tse, “The approximate capacity of the many-to-one and one-to-many Gaussian interference
channels,” IEEE Trans. Inf. Theory, vol. 56, pp. 4566–4592, Sept. 2010.
[56] R. Prasad, S. Bhashyam, and A. Chockalingam, “On the Gaussian many-to-one X channel,” IEEE Trans. Inf. Theory,
vol. 62, pp. 244–259, Jan. 2016.
[57] M. Zeng, A. Yadav, O. A. Dobre, G. I. Tsiropoulos, and H. V. Poor, “Capacity comparison between MIMO-NOMA and
MIMO-OMA with multiple users in a cluster,” IEEE J. Sel. Areas Commun., vol. PP, no. 99, pp. 1–1, 2017.
[58] A. S. Avestimehr, S. N. Diggavi, and D. Tse, “Wireless network information flow: A deterministic approach,” IEEE Trans.
Inf. Theory, vol. 57, pp. 1872–1905, Apr. 2011.
